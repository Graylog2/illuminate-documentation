<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Illuminate Changelogs</title>
    </head>
    <body>
        <h2>Illuminate 4.2.0</h2>
        <p>Released:&#160;2021-02-08</p>
        <h4>Known Issues</h4>
        <ul>
            <li>
                <p><b>The minimum Graylog version required for this version of Illuminate is Graylog 5.1.11 or 5.2.4. (1808)</b>
                </p>
            </li>
            <li>
                <p>If you are running a Graylog 5.1.x version prior to 5.1.11 or a Graylog 5.2.x version prior to 5.2.4, <b>DO NOT ENABLE THIS BUNDLE</b> until your Graylog systems are upgraded to one of the supported versions.</p>
            </li>
        </ul>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Sysmon:Add <code class="linecode">source_reference</code> selection for DNS query events (Sysmon Event ID 22). (1843)</p>
            </li>
            <li>
                <p>AWS Security Lake: Added support for Security Lake. (1724)</p>
            </li>
            <li>
                <p>The input supports the following objects: <code class="linecode">actor</code>, <code class="linecode">anwers</code>, <code class="linecode">api</code>, <code class="linecode">attack</code>, <code class="linecode">cloud</code>, <code class="linecode">compliance</code>, <code class="linecode">connection_info</code>, <code class="linecode">cve</code>, <code class="linecode">device</code>, <code class="linecode">dns_answer</code>, <code class="linecode">dns_query</code>, <code class="linecode">email</code>, <code class="linecode">endpoint</code>, <code class="linecode">file</code>, <code class="linecode">finding</code>, <code class="linecode">http_request</code>, <code class="linecode">http_response</code>, <code class="linecode">identity</code>, <code class="linecode">malware</code>, <code class="linecode">metadata</code>, <code class="linecode">process</code>, <code class="linecode">resources</code>, <code class="linecode">network_proxy</code>, <code class="linecode">proxy</code>, <code class="linecode">query</code>, <code class="linecode">user</code>, <code class="linecode">dst_endpoint</code>, <code class="linecode">traffic</code>, and <code class="linecode">src_endpoint</code>.</p>
            </li>
            <li>
                <p>Added optional Core pack to enrich events with DNS <code class="linecode">query_request</code> or DNS <code class="linecode">query_response</code> fields with additional data. (1676)</p>
            </li>
            <li>
                <p> When enabled this pack will identify any messages processed by core which have the DNS message query fields <code class="linecode">query_request</code> or <code class="linecode">query_response</code> and enrich those fields. Messages with <code class="linecode">query_request</code> will have the fields <code class="linecode">query_request_length</code> and <code class="linecode">query_request_entropy</code> added. Messages with <code class="linecode">query_response</code> will have the field <code class="linecode">query_response_length</code> added.</p>
            </li>
            <li>
                <p>Checkpoint FW: Add rule and layer widgets to Spotlight. (1833)</p>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Fortigate: Convert identification rule to regex instead of grok. (1858)</p>
            </li>
            <li>
                <p>Anomaly Detection: Fix pack titles. (1707)</p>
            </li>
            <li>
                <p>Windows: Non-Security event logs sent with NXlog are not processed. (1867)</p>
            </li>
            <li>
                <p>Sysmon: DNS events assigned legacy code 140100. (1826)</p>
            </li>
            <li>
                <p>BIND DNS: Normal queries not extracted to schema fields and not categorized. (1835)</p>
            </li>
            <li>
                <p>Checkpoint FW: Vendor action "Reject" not mapped to <code class="linecode">event_action</code>. (1832)</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>Sysmon: Split DNS responses in to individual values. (1828)</p>
            </li>
            <li>
                <p>Checkpoint FW: Layered treestructure dropped during processing. (1823)</p>
            </li>
            <li>
                <p>Checkpoint Firewall: Events sometimes contained multiple values for some fields but only the first value was extracted. The following fields now contain a full list of extracted values: <code class="linecode">rule_name</code>, <code class="linecode">rule_id</code>, <code class="linecode">vendor_layer_name</code>, <code class="linecode">vendor_layer_id</code>, <code class="linecode">vendor_match_id</code>, <code class="linecode">vendor_parent_rule</code>, <code class="linecode">vendor_rule_action</code>.</p>
            </li>
            <li>
                <p>Move DNS query request and response length calculations out of GIM enforcement. (1730)</p>
            </li>
            <li>
                <p>Sysmon: Spotlight dashboards updated to use the DNS response GIM event type code (140200) instead of the DNS transaction code (140100). (1837)</p>
            </li>
        </ul>
        <h2>Illuminate 4.1.0</h2>
        <p>Released: 2024-01-04</p>
        <h4>Known Issues</h4>
        <ul>
            <li>
                <p><b>The minimum version required for this version of Illuminate is Graylog 5.1.10 or 5.2.3</b>. (1808)</p>
                <ul>
                    <li>
                        <p>If you are running a Graylog 5.1.x version prior to 5.1.10, or a Graylog 5.2.x version prior to 5.2.3, <b>DO NOT ENABLE THIS BUNDLE</b> until your Graylog systems are upgraded to one of the supported versions.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Okta: Switch from using the field <code class="linecode">vendor_event_action</code> to using the field <code class="linecode">vendor_event_type</code>. (1789)</p>
            </li>
            <li>
                <p>Okta: Extract <code class="linecode">user_domain</code> from <code class="linecode">user_name</code>. (1751)</p>
            </li>
            <li>
                <p>Powershell: If the registry gets changed via a reg command, the fields <code class="linecode">registry_type</code> and <code class="linecode">registry_path</code> are parsed out and get categorized. (633)</p>
                <ul>
                    <li>
                        <p>Logging for <code class="linecode">event_id 4104</code> must be enabled (script block logging).</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Added parsing for Cisco Meraki MR logs. (788)(1687)</p>
                <ul>
                    <li>
                        <p>Added support for Meraki association, disassociation, <code class="linecode">wpa_auth</code>, <code class="linecode">wpa_deauth</code>, <code class="linecode">8021x_eap_failure</code>, <code class="linecode">8021x_deauth</code>, <code class="linecode">8021x_auth</code>, <code class="linecode">8021x_eap_success</code>, <code class="linecode">splash_auth</code>, <code class="linecode">mac_spoofing</code>, <code class="linecode">multiple_servers</code>, and <code class="linecode">device_packet_flood</code> MR events. All ports are now numeric values.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Add record type enrichment. (1806)</p>
                <ul>
                    <li>
                        <p>Added an enrichment that provides a description of the Office 365 record type. This enrichment is only available on the updated Office 365 inputs, available in Graylog after X.X.X, or for prior versions of the Office 365 inputs with the <code class="linecode">full_message</code> option enabled.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>BIND: Add support for <code class="linecode">severity_level</code> mapping and support new log types. (1669)(1725)</p>
                <ul>
                    <li>
                        <p>Mapped all severity levels to our schema and added support for BIND security log type.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: User email field contains the user ID value. (1749)</p>
                <ul>
                    <li>
                        <p>This has been addressed in the updated Illuminate Office 365 processing but still exists with the Office 365 integration prior to 5.1.10 without the <code class="linecode">full_message</code> capability enabled.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Update Illuminate Pack Titles (1704)</p>
            </li>
            <li>
                <p>SEPM: Fix a client traffic log issue where having a null Remote Host Name broke parsing. (1784)</p>
            </li>
            <li>
                <p>Okta: Problems with <code class="linecode">policy.evaluate_sign_on</code> processing. (1794)</p>
                <ul>
                    <li>
                        <p>Change categorization of the policy evaluation rule <code class="linecode">policy.evaluate_sign_on</code> to <code class="linecode">authentication.default</code>.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Alerts generating GIM errors (1425)</p>
            </li>
            <li>
                <p>O365: Exchange ModifyFolderPermissions incorrectly categorized as <code class="linecode">iam.object modify</code>. (1803)</p>
            </li>
            <li>
                <p>Okta: Categorize user.authentication.sso as credential validation event. (1752)</p>
            </li>
            <li>
                <p>Ubiquiti Unifi: Dnsmasq events using legacy GIM type multi-code assignment. (1746)</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>Removed <code class="linecode">alert_severity_level</code> mapping functions/lookups. (1718)</p>
                <ul>
                    <li>
                        <p>Removed <code class="linecode">alert_severity_level</code> mapping functions/lookups. Snort3 pack now relies on core to map <code class="linecode">alert_severity_level</code> from <code class="linecode">alert_severity</code>. <code class="linecode">alert_severity_level</code> should no longer be a string as well.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Removed rules that processed logs and fields tied to the initial Snort3 filebeat configuration. (1715)</p>
                <ul>
                    <li>
                        <p>The initial release of the Snort3 pack did not set the target field in the Filebeat configuration.  Current documentation notes adding 'target: "snort3"' which is required for proper log processing.  This release now fully requires that field to be set.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Meraki: Renamed WiFi fields to match the schema. (1719)</p>
            </li>
            <li>
                <p>Okta: Update Illuminate processing to support updates to the Okta input. (1789)</p>
                <ul>
                    <li>
                        <p>Parsing of Okta messages will be moved from the Graylog Okta input to Illuminate. This will allow for more rapid response to Okta message processing requests as they can now be provided by Illuminate updates, which can be released more frequently, instead of relying on Graylog Enterprise updates. This pack will maintain support for the legacy Okta inputs until Illuminate 6.0 is released. At that time, the support for the legacy Okta input message format will be removed. Support for the enhanced processing can be enabled on the Okta legacy input by enabling the <code class="linecode">full_message</code> feature in the Okta input configuration.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Add logic to support parsing full message. (1769)</p>
                <ul>
                    <li>
                        <p>Parsing of Office 365 messages will be moved from the Graylog Office 365 integration input to Illuminate. Migrating the parsing out of the integration input improves the ability to update the parsing rules on a more frequent basis. Support for the updated Office 365 message processing can be enabled on the Office 365 legacy input by enabling the <code class="linecode">full_message</code> feature in the Office 365 input configuration.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Sophos :Renamed WiFi fields to match the schema. (1721)</p>
            </li>
            <li>
                <p>Modified the Zeek message field construction to only use the even description field which is derived from a lookup. (1329)</p>
                <ul>
                    <li>
                        <p>The message field is now only composed of the event description (derived from lookup).  The prefix 'Zeek - ' will no longer be appended and <code class="linecode">vendor_event_log_description</code> is removed. (now message).</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Defender EP: Added logic to dedup the <code class="linecode">user_name</code> field. (1693)</p>
                <ul>
                    <li>
                        <p>Previously, the <code class="linecode">user_name</code> field array could contain the same <code class="linecode">user_name</code> multiple times.  Added logic to dedup similar names.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Okta: Improve handling of vendor client geo information. (1795)</p>
                <ul>
                    <li>
                        <p>Normalize Okta-provided geolocation enrichment data to fields with the prefix <code class="linecode">vendor_client_geo</code>. This will prevent the Okta-provided geolocation enrichments from colliding with the Graylog-provided Geolocation enrichments.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Fortigate: Renamed WiFi fields to match the schema. (1717)</p>
            </li>
        </ul>
        <h4>Removed</h4>
        <ul>
            <li>
                <p>O365:Remove Skype Office 365 tab (1806)</p>
                <ul>
                    <li>
                        <p>Skype For Business was retired in July of 2021.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h2>Illuminate 4.0.0</h2>
        <p>Released:&#160;2023-11-01</p>
        <h4>Known Issues</h4>
        <ul>
            <li>
                <p><b>Installing this Illuminate release will cause any currently running Anomaly Detection jobs to be disabled.</b> Please identify which Anomaly Detection jobs are running prior to activating this release and enable them after this version has been activated. </p>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Cisco ASA: Some Authentication messages have GIM errors, logoff are wrong categorized (1421)</p>
            </li>
            <li>
                <p>Added the missing <code class="linecode">destination_reference</code> field for ASA authentication messages between 606001 and 606004. Logout messages are now categorizes as logout messages and <code class="linecode">vendor_event_action</code> is now success.</p>
            </li>
            <li>
                <p>Sophos Firewall: Spotlight widgets including non-Sophos data (1686)</p>
            </li>
            <li>
                <p>SonicWall saved search widget modification and dashboard spelling correction (1557)</p>
            </li>
            <li>
                <p>The Message Count by Severity widget in the SonicWall NGFW Log Viewer - Filtered saved search had a confusing sort order.  Corrected to sort by <code class="linecode">vendor_event_severity_level</code>.  Also, fixed the spelling of the Dashboard - previously started with <code class="linecode">Illuminate:*</code> and corrected to <code class="linecode">Illuminate:*</code></p>
            </li>
            <li>
                <p>Sysmon: add <code class="linecode">file_is_executable</code> extraction for Event ID 28 (1552)</p>
            </li>
            <li>
                <p>ASA dashboard has confusing severity levels (1559)</p>
            </li>
            <li>
                <p>Stormshield Bugfixes and Enhancement (1610)</p>
            </li>
            <li>
                <p>Updated bugfix rule to account for logs that contain a <code class="linecode">cat_site</code> AND <code class="linecode">arg</code> field. An existing Stormshield bug adds an extra quotation mark to the <code class="linecode">cat_site</code> field value which breaks parsing.</p>
            </li>
            <li>
                <p>Sysmon: Normalize Event Type to <code class="linecode">vendor_event_type</code> for all related Sysmon events (1576)</p>
            </li>
            <li>
                <p>Cisco ASA:Alert severity not assigned for some 338002 messages (1420)</p>
            </li>
            <li>
                <p>All dynamic filter messages 338001 to 338204 now get an alert severity even if the message does not have this field. Renamed field <code class="linecode">vendor_alert_severity1</code> to <code class="linecode">vendor_alert_severity</code></p>
            </li>
            <li>
                <p>Added check for previously identified messages to Checkpoint (1612)</p>
            </li>
            <li>
                <p>Illuminate: Added <code class="linecode">event_error_code</code> mapping as keyword (1674)</p>
                <p><b>NOTE</b>: This may cause a short-term mapping conflict in dashboards where mapping type are updated (such as with Palo Alto) but this conflict will resolve over time. Some products produce an error code as an integer value, some produce codes in other formats such as hex. This field is expected to be a keyword type, but implicit mappings result in mapping conflicts where integer values are mapped as type "long." The static mapping of <code class="linecode">event_error_code</code> as keyword will resolve this mapping conflict.</p>
            </li>
            <li>
                <p>Windows Security: Event 4663 not handled properly (803)</p>
            </li>
            <li>
                <p>Windows 4663 was categorized as a file change but 4663 can reflect changes to multiple components on a system in addition to the file system. Illuminate will now categorize a system based upon the component identified in event ID 4663.</p>
            </li>
            <li>
                <p>Sysmon extracting target process name incorrectly (1575)</p>
            </li>
            <li>
                <p>The field was being extracted incorrectly as <code class="linecode">target_process_name</code>, now extracting it as <code class="linecode">process_target_name</code></p>
            </li>
            <li>
                <p>Symantec Endpoint: Spotlight Alert destinations widget uses source fields (1679)</p>
            </li>
            <li>
                <p>Moved Cisco ASA identification rules from stage 2 to stage 5 (1613)</p>
            </li>
            <li>
                <p>Fortigate: fixed <code class="linecode">event_severity</code> &amp; <code class="linecode">event_severity_level</code> for informational and low (1642)</p>
            </li>
            <li>
                <p>The Fortigate event severity for informational events properly maps to a value  of 1 for <code class="linecode">event_severity_level</code> and informational for <code class="linecode">event_severity</code>.  Additionally, for  the notice Fortigate events, the <code class="linecode">event_severity_level</code> has been corrected with a value of 2 (low).</p>
            </li>
            <li>
                <p>Cisco ASA: Add support for user names with an @ in them. (1661)</p>
            </li>
            <li>
                <p> Checkpoint: Fixed processing of text for severity levels (1688)</p>
            </li>
        </ul>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Added Ubiquiti UniFi Overview dashboard to go along with the existing Ubiquiti UniFi Illuminate pack. (1296)</p>
            </li>
            <li>
                <p>Added new technology pack NGINX Webserver (1207)</p>
            </li>
            <li>
                <p>This pack adds support for NGINX Webserver. It is tested with version 1.18/1.24 with the combined log format.</p>
            </li>
            <li>
                <p>Added Asset pack to Illuminate Security editions</p>
            </li>
            <li>
                <p>Adds the Asset processing pack needed to add the <code class="linecode">associated_assets</code> field to messages used by the Assets feature, available only in Graylog Security.</p>
            </li>
            <li>
                <p>Added support for Audit Security System Extension Windows events (216)</p>
            </li>
            <li>
                <p>Added support for additional Windows Security Event IDs 4610, 4611, 4614, 4622, 4697 which are enabled by the Audit Security System Extension policy in Windows. See <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-security-system-extension">https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-security-system-extension</a> for additional information about these events.</p>
            </li>
            <li>
                <p>Core MITRE lookup that allows the mapping of technique UID to name (1622)</p>
            </li>
            <li>
                <p>Added a new core lookup that maps <code class="linecode">attacks_technique_uid</code> (MITRE ID) to <code class="linecode">attacks_technique_name</code> (MITRE name).  These are new fields.</p>
            </li>
            <li>
                <p>Updated Juniper documentation to include required input setting for proper processing (1569)</p>
            </li>
            <li>
                <p>Added full support for Cisco Firepower (1449)</p>
            </li>
            <li>
                <p>Adding full parsing for Cisco Firepower FTD events. Event IDs between 430001 and 430005 are now fully supported. This Illuminate pack will process the Cisco Firepower logs delivered to Graylog via Syslog and is not for use with the Cisco Firepower Event Streamer (eStreamer)/eNcore agents. The pack supports %FTD, %NGIPS, %NGFW (and %ASA) logs.</p>
            </li>
            <li>
                <p> Illuminate: The <code class="linecode">http_response_code</code> field now gets enriched. The new field <code class="linecode">http_response</code> describes the response code. (1633)</p>
            </li>
            <li>
                <p>Windows Security: Add access list enrichment (1644)</p>
            </li>
            <li>
                <p>Windows 4663 contains codes that reflect the types of accesses requested. Add an enrichment that will provide a plain text description of these access list codes in the field <code class="linecode">vendor_access_type</code>.</p>
            </li>
            <li>
                <p>CrowdStrike Falcon Technology Pack (1483)</p>
            </li>
            <li>
                <p>CrowdStrike Falcon technology pack release. Supports alerts and authentication events received by the CrowdStrike input, and includes a spotlight pack with an overview tab, authentication tab, and alert tab.</p>
            </li>
            <li>
                <p>Microsoft Defender for Endpoint Technology Pack (1540)</p>
            </li>
            <li>
                <p>Microsoft Defender for Endpoint technology pack release.  Supports 'alerts' events received by the Microsoft Defender for Endpoint Graylog input. Also adds a new core lookup that maps <code class="linecode">attacks_technique_uid</code> (MITRE ID) to <code class="linecode">attacks_technique_name</code> (MITRE name).  These are new fields.</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>GIM Enforcement:Change enforced source and destination fields for events categorized as network messages (1524)</p>
            </li>
            <li>
                <p>Reference fields (<code class="linecode">source_reference</code>, <code class="linecode">destination_reference</code>) are selected from a list of possible source fields such as <code class="linecode">source_ip</code>, <code class="linecode">destination_ip</code>, and <code class="linecode">source_hostname</code>. Defining the required fields for the network category to use these reference fields instead of only the IP fields will allow more messages to be categorized as network messages. Some sources will provide hostnames or mac addresses instead of IPs, changing the required field to use a reference field enables those messages to also be categorized as network messages.</p>
            </li>
            <li>
                <p>Core: Revised reference field processing (1685)</p>
            </li>
            <li>
                <p>Reference fields (<code class="linecode">host_reference</code>, <code class="linecode">source_reference</code>, <code class="linecode">destination_reference</code>) are now processed for any message with candidate fields and not just categorized messages. Any messages with source/host/destination IP, hostname, or MAC fields will now have associated reference fields added. For example, a message with <code class="linecode">host_ip</code>, <code class="linecode">host_hostname</code>, or <code class="linecode">host_mac </code>will have a  <code class="linecode">host_reference</code> field generated.</p>
            </li>
            <li>
                <p>Convert Illuminate Spotlight content IP fields to instead use reference fields (1673)</p>
            </li>
            <li>
                <p> Many existing Illuminate dashboards use the IP fields (<code class="linecode">source_ip</code>, <code class="linecode">destination_ip</code>, <code class="linecode">host_ip</code>) for aggregations but the use of fields with the IP mappings commonly run into aggregation errors. Converting the IP field use in aggregations to instead the "reference" fields (<code class="linecode">source_reference</code>, <code class="linecode">destination_reference</code>, <code class="linecode">host_reference</code>) will use keyword-mapped fields while retaining the ability to search the IP-based fields with CIDR functions and ranged searches, which will reduce the number of aggregations errors when viewing Illuminate content. Reference fields are selected from multiple potential fields (such as <code class="linecode">source_ip</code>, <code class="linecode">source_hostname</code>, <code class="linecode">source_mac</code>, and others) but will typically contain the original IP field data as that field as the IP field is typically the first choice selected when it exists.</p>
            </li>
            <li>
                <p>Converted <code class="linecode">gim_event_type_code</code> assignments to support multiple values (1504)</p>
            </li>
            <li>
                <p>The assignment of a `<code class="linecode">gim_event_type_code</code>` value has been limited to one value. With this change the `<code class="linecode">gim_event_type_code</code>` field is now a list of values and multiple codes can be assigned. This change requires Graylog 5.1.5 or greater.</p>
            </li>
            <li>
                <p>Rename original Microsoft Defender content to Microsoft Defender Antivirus (1654)</p>
            </li>
        </ul>
    </body>
</html>