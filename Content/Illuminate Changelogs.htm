<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Illuminate Changelogs</title>
    </head>
    <body>
        <h2>Illuminate 5.2.0</h2>
        <p>Released:&#160;2024-08-07</p>
        <h4>Added</h4>
        <ul>
            <li>
                <p>MS365: Add processing for Security &amp; Compliance Center events (2104)</p>
            </li>
            <li>
                <p>MS Defender for Endpoint: Added user, hostname, and MITRE widgets to spotlight (2185)</p>
                <ul>
                    <li>
                        <p>Added two new widgets to spotlight: alert count by <code class="linecode">user_name</code> and <code class="linecode">host_hostname</code> to the Overview page and moved the MITRE technique widget to it's own page, which also now includes a MITRE <code class="linecode">process_name</code> heat map widget. Also, all widgets are now scoped to the Microsoft Defender for Endpoint stream.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>MS365: Add processing for ListBaseType objects. (2139)</p>
            </li>
            <li>
                <p>Add new GIM category: Detection (2021)</p>
                <ul>
                    <li>
                        <p>The new "detection" category will replace the "Alert" category which has been deprecated and will be removed in Illuminate 7.0.0. This has been added to clear up confusion around the term "alerts." Detections is an assignment for detections generated by a security monitoring solutions, such as IDS/IPS, DLP, or antivirus/malware, or other indications that potentially malicious or unwanted activity has been detected.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p><a href="Content Packs/Sendmail Content Pack.html">Sendmail</a>: Added support for Sendmail mail server (2065)</p>
                <ul>
                    <li>
                        <p>Sendmail is a free and open-source mail transfer agent (MTA) used to route and deliver email on Unix-based systems.  This content pack supports most common logs and features dashboards to visualize sender/recipient activity,  delivery status, ruleset rejections, authentication, and processing statistics.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Added Microsoft Windows Security - Windows Activity Sigma Rules (2067)</p>
                <ul>
                    <li>
                        <p>Adds a spotlight pack containing Sigma-formatted alerts provided by SOC Prime and curated by the Graylog team. This may include some modifications of the source rules to align with the GIM schema and the Graylog team's findings.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Windows: Add Winlogbeat Event Original Retention content pack. (1358)</p>
                <ul>
                    <li>
                        <p>Enabling this pack retains the <code class="linecode">winlogbeat_event_original</code> field in Winlogbeat-forwarded messages.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Postfix: Added support if <code class="linecode">application_name</code> starts with postfix (2134)</p>
                <ul>
                    <li>
                        <p>Rsyslog sends as <code class="linecode">application_name</code> always postfix, but other log forwarders will attach the daemon/module.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>MS365: Add processing for Teams events (2151)</p>
            </li>
            <li>
                <p>MS365: Add processing for Compliance Posture Management events (2158)</p>
            </li>
            <li>
                <p><a href="Anomaly Detection/Anomaly Detection.htm">Anomaly</a>: Extend MS365 authentication AD rule to include all authentication (2229)</p>
                <ul>
                    <li>
                        <p>The previous anomaly detection rule to track MS365 authentication only looked at failed logins. The updated Anomaly Detection Spotlight includes an updated MS365 with features for both all authentication and failed authentication.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Fixed</h4>
        <p>- Illuminate Core allows duplicate gim_event_subcategory values (2030)</p>
        <p>- Lookup-related performance issues (2167)</p>
        <p>- Training Illuminate anomaly detection rules can cause excessive resource utilization (2068)</p>
        <p>- A new pack has been added which provides updates to the existing anomaly detection rules. The updated rules will only use the current write indices for training, where the previous rules contained no such limit. This change may lengthen the time that training the anomaly detection rules takes but will reduce the CPU and memory utiltization during training. These rules are provided as a new pack in order to allow a smoother transition from the legacy rules to the updated rules. The legacy rules Spotlight pack is deprecated, and will be removed from Illuminate 7.0.0.</p>
        <p>- O365: AzureAD/EntraID application_name properly extracted (2168)</p>
        <p>- The application_name field is now properly extracted from .Workload within the JSON message. Previously, the o365_application_id UID was being used and was inaccurate.</p>
        <p>- Rename the Bluecoat Anomaly Detection rule to Symantec (2218)</p>
        <p>- Update the anomaly detection rule name for the ProxySG product in the new Anomaly Detection Spotlight.</p>
        <p>- Postfix: event_created timestamps without year indexed with year set to 1970 (2039)</p>
        <p>- Apache: vendor_event_severity parsed incorrectly in some error logs (2147)</p>
        <p>- The vendor_event_severity field is now properly extracted from some error log message types. Previously, vendor_event_severity would sometimes be assigned to vendor_apache_error_module.</p>
        <p>- CISCO_IOS: added support if the user_name is empty in login logs (2211)</p>
        <p>- MS Defender for Endpoint: Added rule to remove the evidence_array field which is not needed after procecssing. (2201)</p>
        <h4>Changed</h4>
        <p>- Fortigate: Scope dashboard widgets to Fortigate Messages stream. (2188)</p>
        <p>- MS Defender for Endpoint: Removed group by aggregation for alert count widgets (2184)</p>
        <p>- MS365: Scope dashboard widgets to O365 Messages stream. (2110)</p>
        <p>- Postfix: This change improves titles of Spotlight widgets to better represent messages sent and messages not delivered. (2115)</p>
        <p>- Anomaly: Combine the Windows file activity anomaly detection rules into one (2230)</p>
        <p>- The original anomaly detection pack provided three separate rules related to Windows file activity, one rule each for file access, writes, and deletes. These rules are all based off of the same event data and can be combined in to one job.</p>
        <p>- MS365: Processing modifications and renames. (2106)</p>
        <p>- Input derived vendor_event_description now gets set as message, vendor_event_description gets set via a lookup if data exists in the lookup.</p>
        <h2>Illuminate 5.1.0</h2>
        <p>Released:&#160;2024-06-06</p>
        <h4>Added</h4>
        <ul>
            <li>
                <p><a href="Content Packs/Symantec Endpoint Detection and Response Content Pack.htm">Symantec EDR</a>: Symantec Endpoint Detection and Response (EDR) Content Pack (1937)</p>
                <ul>
                    <li>
                        <p>Symantec Endpoint Detection and Response is used to detect advanced attacks using machine learning and global threat intelligence to minimize false positives and help ensure high levels of productivity for security teams.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Core: Added lookup for SMTP descriptions (2024)</p>
            </li>
            <li>
                <p>NGINX: Added support of <code class="linecode">filebeat_application_name</code> as <code class="linecode">application_name</code>. (2061)</p>
            </li>
            <li>
                <p><a href="Content Packs/Cisco IOS Content Pack.html">Cisco IOS</a>: Added support for Cisco IOS (1944)</p>
                <ul>
                    <li>
                        <p>Cisco IOS (Internetwork Operating System): Proprietary software used in Cisco routers and switches, enabling robust management of network traffic, including data, voice, and video across various communications environments.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Apache: Added support of <code class="linecode">filebeat_application_name</code> as <code class="linecode">application_name</code>. (2061)</p>
            </li>
            <li>
                <p>MITRE ATT&amp;CK Tactic Lookup (1847)</p>
                <ul>
                    <li>
                        <p>In addition to the existing <code class="linecode">attacks_technique_uid</code> to <code class="linecode">attacks_technique_name</code> lookup, core will now map <code class="linecode">attacks_tactic_uid</code> to <code class="linecode">attacks_tactic_name</code>.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Add Illuminate Compliance Spotlight (1979)</p>
                <ul>
                    <li>
                        <p>This addition provides an Illuminate Spotlight pack designed to assist with compliance-related activities that are commonly supported by SIEM/log aggregation.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p> <a href="Content Packs/Postfix Content Pack.html">Postfix</a>: Added support for Postfix (1970)</p>
                <ul>
                    <li>
                        <p>This Postfix content pack supports most available logs. The content pack also includes a dashboard with four tabs (General Overview, Email Messages, TLS, and SMTP).</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Duplicate message summaries for <code class="linecode">gim_event_subcategory:authentication.credential validation</code>. (1339)</p>
            </li>
            <li>
                <p>Fortigate: Handle structured Syslog messages in Illuminate processing (2005)</p>
                <ul>
                    <li>
                        <p>This fixes an issue with Fortigate processing where the message format causes the Syslog input to parse the message in addition to Illuminate parsing the message, leading to fields being extracted multiple times.  When the Syslog input parses a Fortigate message, Illuminate will now use the fields generated by the input.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Core: Update built-in static accounts list (2085)</p>
                <ul>
                    <li>
                        <p>Update the built-in static accounts enrichments, adding all built-in groups listed by <a href="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/appendix-b--privileged-accounts-and-groups-in-active-directory">Microsoft</a>.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Agent message summary view incomplete (1555)</p>
            </li>
            <li>
                <p>Fortigate: The field <code class="linecode">wifi_channel</code> is always created (2089)</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>Symantec Endpoint Security (SES): Deduplication of <code class="linecode">attacks_tactic_uid</code> field and removal of <code class="linecode">attacks_tactic_id</code>. (2070)</p>
                <ul>
                    <li>
                        <p>In some SES logs, the <code class="linecode">attacks_tactic_uid</code> field can contain similar values.  Added logic to de-duplicate those values. The <code class="linecode">attacks_tactic_id</code> field has been removed, which is better represented by <code class="linecode">attacks_tactic_uid</code>.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Allow merging of user/device category fields (167)</p>
                <ul>
                    <li>
                        <p>Graylog Illuminate core has provided two lookup tables to define account and device category and priority data, but any category data defined prior to Illuminate Core running would prevent data in the static device/account lookups from being added. The category data in the Illuminate core static accounts and devices lookups will now be merged with any duplicate values being removed when detected.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Symantec Endpoint Security (SES): MITRE Tactic ID &amp; UID Extraction Update (1991)</p>
            </li>
            <li>
                <p>Core: Enrich all events with a user field with category and priority data (2086)</p>
                <ul>
                    <li>
                        <p>Remove the requirement to categorize a message before enriching events with user fields (<code class="linecode">user_name</code>, <code class="linecode">source_user_name</code>, <code class="linecode">target_user_name</code>) with category and priority information.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Symantec Endpoint Security (SES): Force <code class="linecode">vendor_data_entity_uid</code> to be indexed as a string, no matter the subtype. (2058)</p>
                <ul>
                    <li>
                        <p>This change requires rotating the SES index to incorporate the updated field type.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Add support for Postfix-style timestamps (2035)</p>
            </li>
        </ul>
        <h2>Illuminate 5.0.1</h2>
        <p>Released:&#160;2024-05-14</p>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Symantec Endpoint Security (SES): Spotlight Not Defining Minimum Version. (1942)</p>
            </li>
            <li>
                <p> Windows Security: Curated Alerts Spotlight Not Defining Minimum Version. (2013)</p>
            </li>
            <li>
                <p>Windows Security:NXLog not extracting process parent information from 4688. (2010)</p>
            </li>
            <li>
                <p>Windows Security:Event process ID is not reliably extracted from Window Security logs. (2016)</p>
            </li>
        </ul>
        <h2>Illuminate 5.0.0</h2>
        <p>Released:&#160;2024-05-06</p>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Packetbeat: New content request from the customer (1851)</p>
                <ul>
                    <li>
                        <p>With this addition, we will be supporting all Packetbeat logs, but we are currently focusing on enriching DNS, HTTP, and Flow logs specifically as well as adding a spotlight with three tabs: An overview tab, Flow network overview tab, and an HTTP overview tab as well.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Added support for Windows Security Event ID 1108 (827)</p>
                <ul>
                    <li>
                        <p>See <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-1108">Microsoft documentation</a> for additional information about the event.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Added extraction for process information for Event Ids 4798, 4799 (266)</p>
                <ul>
                    <li>
                        <p>Added NXLog and WLB7 field processing for <code class="linecode">process_path/id</code> values from events.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Symantec Endpoint Security (SES):Initial technology pack (1732)</p>
                <ul>
                    <li>
                        <p>Symantec Endpoint Security is a cloud and hybrid-managed solution that provides the protection of SEP, attack detection of EDR, and other technologies to secure devices.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Add Network subcategory for ICMP (1696)</p>
            </li>
            <li>
                <p>HAProxy: Added support for HAProxy (1854)</p>
                <ul>
                    <li>
                        <p>This HAProxy content pack supports default, TCP, HTTP, HTTPS and Error logs.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Added Microsoft Windows Security - User Activity Sigma Rules (1852)</p>
                <ul>
                    <li>
                        <p>Adds a spotlight pack containing Sigma-formatted alerts provided by SOC Prime and curated by the Graylog team. This may include some modifications of the source rules to align with the GIM schema and the Graylog team's findings.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Add new field <code class="linecode">gl2_processing_duration_ms</code> to Illuminate field mapping templates (1891)</p>
            </li>
            <li>
                <p>Graylog API Security Content Pack (1937)</p>
                <ul>
                    <li>
                        <p>Initial Graylog API Security Spotlight which includes an Overview tab highlighting API calls and alerts. Please <a href="Content Packs/Security Content Packs.html">see the Graylog documentation</a> for more information on the spotlight pack and how to configure API Security to send logs to your Graylog instance.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Sophos:Field normalization failure due to space in field name (1963)</p>
            </li>
            <li>
                <p>Winlogbeat provides timestamp fields that are detected as dates but cause indexing failures (1902)</p>
                <ul>
                    <li>
                        <p>This will disable date detection on all Winlogbeat "event data" fields. These fields are dynamically parsed by the winlogbeat agent in to individual fields. This addresses an issue where some event log messages may be rejected due to an index mapping type conflict related to some fields. This is due to the event data fields are either occasionally timestamps, or are timestamps but contain different timestamp formats, likely due to local system settings. This change will cause all Winlogbeat "event data" fields to be indexed with the mapping type "keyword." The side effect of this change is that some event data fields may be limited in how they can be analyzed in aggregate, or search. This change will not impact non-event data fields, or any fields that have been renamed by Illuminate.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Windows Security:fixed <code class="linecode">process_path</code> renaming (1841)</p>
                <ul>
                    <li>
                        <p>Windows security processing sets the <code class="linecode">process_name</code> path with a value that is the full path of the process. This should be instead extracted to <code class="linecode">process_path</code> for both NXlog and Winlogbeat agents.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Symantec EP:Virus found logs not processed (1932)</p>
            </li>
            <li>
                <p>CBDefense: Key value extraction generates illegal key name (1964)</p>
            </li>
            <li>
                <p>SEPM: Updated dashboard to use detection instead of Alert. (1952)(1956)(1959)</p>
                <ul>
                    <li>
                        <p>We are changing the way we use the word alert, which will be handled more so by the new curated alerts that will be coming soon, and so we want to start changing all the usages of the word alert to be detection. The first pack we are focusing on is the SEPM dashboards. We also added scoped streams to this dashboard as well.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Windows Security:Improve accuracy of <code class="linecode">user_type</code> identification pattern (1879)</p>
                <ul>
                    <li>
                        <p>The Illuminate Windows Security event processing was not identifying likely computer names which began with a number. The Illuminate process of setting a user type based on the format of the logs is a best effort process, there is no way to precisely identify if an account is a user or machine account based on log data alone.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Auditbeat:Will not process events with multiple <code class="linecode">vendor_event_action</code> values (622)</p>
            </li>
            <li>
                <p>O365:Updated messages incorrectly identified as legacy messages (1967)</p>
            </li>
            <li>
                <p>Sonicwall assigning legacy GIM event code (1822)</p>
            </li>
            <li>
                <p>Windows: nxlog <code class="linecode">process_id</code> not extracted properly (1926)</p>
            </li>
            <li>
                <p>Palo Alto:Global Protect categorization uses legacy GIM code (1818)</p>
            </li>
            <li>
                <p>Cisco ASA: SFIMS message normalization target fields contain spaces (1966)</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>Changed <code class="linecode">vendor_message</code> to message for Watchguard firebox (1496)</p>
                <ul>
                    <li>
                        <p>The message field contains a lot of data that is extracted into other fields. Removing this and rewriting the message will: Reduce storage utilization Reduce duplication of data Lower computational cost for the pattern-based extraction</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Removed</h4>
        <ul>
            <li>
                <p>GIM Enforcement:Removed field enforcement of DNS transaction events (1739)</p>
                <ul>
                    <li>
                        <p>The DNS transaction event type has been removed. DNS events that contain both query and answer data are now assigned the relevant GIM codes for each of those events.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Removed event_source enforcement from GIM enforcement rules (1782)</p>
                <ul>
                    <li>
                        <p>The <code class="linecode">event_source</code> field is deprecated and will be removed entirely from Illuminate 6.0.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h2>Illuminate 4.2.0</h2>
        <p>Released:&#160;2024-02-08</p>
        <h4>Known Issues</h4>
        <ul>
            <li>
                <p><b>The minimum Graylog version required for this version of Illuminate is Graylog 5.1.11 or 5.2.4. (1808)</b>
                </p>
            </li>
            <li>
                <p>If you are running a Graylog 5.1.x version prior to 5.1.11 or a Graylog 5.2.x version prior to 5.2.4, <b>DO NOT ENABLE THIS BUNDLE</b> until your Graylog systems are upgraded to one of the supported versions.</p>
            </li>
        </ul>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Sysmon:Add <code class="linecode">source_reference</code> selection for DNS query events (Sysmon Event ID 22). (1843)</p>
            </li>
            <li>
                <p>AWS Security Lake: Added support for Security Lake. (1724)</p>
            </li>
            <li>
                <p>The input supports the following objects: <code class="linecode">actor</code>, <code class="linecode">anwers</code>, <code class="linecode">api</code>, <code class="linecode">attack</code>, <code class="linecode">cloud</code>, <code class="linecode">compliance</code>, <code class="linecode">connection_info</code>, <code class="linecode">cve</code>, <code class="linecode">device</code>, <code class="linecode">dns_answer</code>, <code class="linecode">dns_query</code>, <code class="linecode">email</code>, <code class="linecode">endpoint</code>, <code class="linecode">file</code>, <code class="linecode">finding</code>, <code class="linecode">http_request</code>, <code class="linecode">http_response</code>, <code class="linecode">identity</code>, <code class="linecode">malware</code>, <code class="linecode">metadata</code>, <code class="linecode">process</code>, <code class="linecode">resources</code>, <code class="linecode">network_proxy</code>, <code class="linecode">proxy</code>, <code class="linecode">query</code>, <code class="linecode">user</code>, <code class="linecode">dst_endpoint</code>, <code class="linecode">traffic</code>, and <code class="linecode">src_endpoint</code>.</p>
            </li>
            <li>
                <p>Added optional Core pack to enrich events with DNS <code class="linecode">query_request</code> or DNS <code class="linecode">query_response</code> fields with additional data. (1676)</p>
            </li>
            <li>
                <p> When enabled this pack will identify any messages processed by core which have the DNS message query fields <code class="linecode">query_request</code> or <code class="linecode">query_response</code> and enrich those fields. Messages with <code class="linecode">query_request</code> will have the fields <code class="linecode">query_request_length</code> and <code class="linecode">query_request_entropy</code> added. Messages with <code class="linecode">query_response</code> will have the field <code class="linecode">query_response_length</code> added.</p>
            </li>
            <li>
                <p>Checkpoint FW: Add rule and layer widgets to Spotlight. (1833)</p>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Fortigate: Convert identification rule to regex instead of grok. (1858)</p>
            </li>
            <li>
                <p>Anomaly Detection: Fix pack titles. (1707)</p>
            </li>
            <li>
                <p>Windows: Non-Security event logs sent with NXlog are not processed. (1867)</p>
            </li>
            <li>
                <p>Sysmon: DNS events assigned legacy code 140100. (1826)</p>
            </li>
            <li>
                <p>BIND DNS: Normal queries not extracted to schema fields and not categorized. (1835)</p>
            </li>
            <li>
                <p>Checkpoint FW: Vendor action "Reject" not mapped to <code class="linecode">event_action</code>. (1832)</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>Sysmon: Split DNS responses in to individual values. (1828)</p>
            </li>
            <li>
                <p>Checkpoint FW: Layered treestructure dropped during processing. (1823)</p>
            </li>
            <li>
                <p>Checkpoint Firewall: Events sometimes contained multiple values for some fields but only the first value was extracted. The following fields now contain a full list of extracted values: <code class="linecode">rule_name</code>, <code class="linecode">rule_id</code>, <code class="linecode">vendor_layer_name</code>, <code class="linecode">vendor_layer_id</code>, <code class="linecode">vendor_match_id</code>, <code class="linecode">vendor_parent_rule</code>, <code class="linecode">vendor_rule_action</code>.</p>
            </li>
            <li>
                <p>Move DNS query request and response length calculations out of GIM enforcement. (1730)</p>
            </li>
            <li>
                <p>Sysmon: Spotlight dashboards updated to use the DNS response GIM event type code (140200) instead of the DNS transaction code (140100). (1837)</p>
            </li>
        </ul>
        <h2>Illuminate 4.1.0</h2>
        <p>Released: 2024-01-04</p>
        <h4>Known Issues</h4>
        <ul>
            <li>
                <p><b>The minimum version required for this version of Illuminate is Graylog 5.1.10 or 5.2.3</b>. (1808)</p>
                <ul>
                    <li>
                        <p>If you are running a Graylog 5.1.x version prior to 5.1.10, or a Graylog 5.2.x version prior to 5.2.3, <b>DO NOT ENABLE THIS BUNDLE</b> until your Graylog systems are upgraded to one of the supported versions.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Okta: Switch from using the field <code class="linecode">vendor_event_action</code> to using the field <code class="linecode">vendor_event_type</code>. (1789)</p>
            </li>
            <li>
                <p>Okta: Extract <code class="linecode">user_domain</code> from <code class="linecode">user_name</code>. (1751)</p>
            </li>
            <li>
                <p>Powershell: If the registry gets changed via a reg command, the fields <code class="linecode">registry_type</code> and <code class="linecode">registry_path</code> are parsed out and get categorized. (633)</p>
                <ul>
                    <li>
                        <p>Logging for <code class="linecode">event_id 4104</code> must be enabled (script block logging).</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Added parsing for Cisco Meraki MR logs. (788)(1687)</p>
                <ul>
                    <li>
                        <p>Added support for Meraki association, disassociation, <code class="linecode">wpa_auth</code>, <code class="linecode">wpa_deauth</code>, <code class="linecode">8021x_eap_failure</code>, <code class="linecode">8021x_deauth</code>, <code class="linecode">8021x_auth</code>, <code class="linecode">8021x_eap_success</code>, <code class="linecode">splash_auth</code>, <code class="linecode">mac_spoofing</code>, <code class="linecode">multiple_servers</code>, and <code class="linecode">device_packet_flood</code> MR events. All ports are now numeric values.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Add record type enrichment. (1806)</p>
                <ul>
                    <li>
                        <p>Added an enrichment that provides a description of the Office 365 record type. This enrichment is only available on the updated Office 365 inputs, available in Graylog after X.X.X, or for prior versions of the Office 365 inputs with the <code class="linecode">full_message</code> option enabled.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>BIND: Add support for <code class="linecode">severity_level</code> mapping and support new log types. (1669)(1725)</p>
                <ul>
                    <li>
                        <p>Mapped all severity levels to our schema and added support for BIND security log type.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: User email field contains the user ID value. (1749)</p>
                <ul>
                    <li>
                        <p>This has been addressed in the updated Illuminate Office 365 processing but still exists with the Office 365 integration prior to 5.1.10 without the <code class="linecode">full_message</code> capability enabled.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Update Illuminate Pack Titles (1704)</p>
            </li>
            <li>
                <p>SEPM: Fix a client traffic log issue where having a null Remote Host Name broke parsing. (1784)</p>
            </li>
            <li>
                <p>Okta: Problems with <code class="linecode">policy.evaluate_sign_on</code> processing. (1794)</p>
                <ul>
                    <li>
                        <p>Change categorization of the policy evaluation rule <code class="linecode">policy.evaluate_sign_on</code> to <code class="linecode">authentication.default</code>.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Alerts generating GIM errors (1425)</p>
            </li>
            <li>
                <p>O365: Exchange ModifyFolderPermissions incorrectly categorized as <code class="linecode">iam.object modify</code>. (1803)</p>
            </li>
            <li>
                <p>Okta: Categorize user.authentication.sso as credential validation event. (1752)</p>
            </li>
            <li>
                <p>Ubiquiti Unifi: Dnsmasq events using legacy GIM type multi-code assignment. (1746)</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>Removed <code class="linecode">alert_severity_level</code> mapping functions/lookups. (1718)</p>
                <ul>
                    <li>
                        <p>Removed <code class="linecode">alert_severity_level</code> mapping functions/lookups. Snort3 pack now relies on core to map <code class="linecode">alert_severity_level</code> from <code class="linecode">alert_severity</code>. <code class="linecode">alert_severity_level</code> should no longer be a string as well.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Removed rules that processed logs and fields tied to the initial Snort3 filebeat configuration. (1715)</p>
                <ul>
                    <li>
                        <p>The initial release of the Snort3 pack did not set the target field in the Filebeat configuration.  Current documentation notes adding 'target: "snort3"' which is required for proper log processing.  This release now fully requires that field to be set.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Meraki: Renamed WiFi fields to match the schema. (1719)</p>
            </li>
            <li>
                <p>Okta: Update Illuminate processing to support updates to the Okta input. (1789)</p>
                <ul>
                    <li>
                        <p>Parsing of Okta messages will be moved from the Graylog Okta input to Illuminate. This will allow for more rapid response to Okta message processing requests as they can now be provided by Illuminate updates, which can be released more frequently, instead of relying on Graylog Enterprise updates. This pack will maintain support for the legacy Okta inputs until Illuminate 6.0 is released. At that time, the support for the legacy Okta input message format will be removed. Support for the enhanced processing can be enabled on the Okta legacy input by enabling the <code class="linecode">full_message</code> feature in the Okta input configuration.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>O365: Add logic to support parsing full message. (1769)</p>
                <ul>
                    <li>
                        <p>Parsing of Office 365 messages will be moved from the Graylog Office 365 integration input to Illuminate. Migrating the parsing out of the integration input improves the ability to update the parsing rules on a more frequent basis. Support for the updated Office 365 message processing can be enabled on the Office 365 legacy input by enabling the <code class="linecode">full_message</code> feature in the Office 365 input configuration.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Sophos :Renamed WiFi fields to match the schema. (1721)</p>
            </li>
            <li>
                <p>Modified the Zeek message field construction to only use the even description field which is derived from a lookup. (1329)</p>
                <ul>
                    <li>
                        <p>The message field is now only composed of the event description (derived from lookup).  The prefix 'Zeek - ' will no longer be appended and <code class="linecode">vendor_event_log_description</code> is removed. (now message).</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Defender EP: Added logic to dedup the <code class="linecode">user_name</code> field. (1693)</p>
                <ul>
                    <li>
                        <p>Previously, the <code class="linecode">user_name</code> field array could contain the same <code class="linecode">user_name</code> multiple times.  Added logic to dedup similar names.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Okta: Improve handling of vendor client geo information. (1795)</p>
                <ul>
                    <li>
                        <p>Normalize Okta-provided geolocation enrichment data to fields with the prefix <code class="linecode">vendor_client_geo</code>. This will prevent the Okta-provided geolocation enrichments from colliding with the Graylog-provided Geolocation enrichments.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Fortigate: Renamed WiFi fields to match the schema. (1717)</p>
            </li>
        </ul>
        <h4>Removed</h4>
        <ul>
            <li>
                <p>O365:Remove Skype Office 365 tab (1806)</p>
                <ul>
                    <li>
                        <p>Skype For Business was retired in July of 2021.</p>
                    </li>
                </ul>
            </li>
        </ul>
        <h2>Illuminate 4.0.0</h2>
        <p>Released:&#160;2023-11-01</p>
        <h4>Known Issues</h4>
        <ul>
            <li>
                <p><b>Installing this Illuminate release will cause any currently running Anomaly Detection jobs to be disabled.</b> Please identify which Anomaly Detection jobs are running prior to activating this release and enable them after this version has been activated. </p>
            </li>
        </ul>
        <h4>Fixed</h4>
        <ul>
            <li>
                <p>Cisco ASA: Some Authentication messages have GIM errors, logoff are wrong categorized (1421)</p>
            </li>
            <li>
                <p>Added the missing <code class="linecode">destination_reference</code> field for ASA authentication messages between 606001 and 606004. Logout messages are now categorizes as logout messages and <code class="linecode">vendor_event_action</code> is now success.</p>
            </li>
            <li>
                <p>Sophos Firewall: Spotlight widgets including non-Sophos data (1686)</p>
            </li>
            <li>
                <p>SonicWall saved search widget modification and dashboard spelling correction (1557)</p>
            </li>
            <li>
                <p>The Message Count by Severity widget in the SonicWall NGFW Log Viewer - Filtered saved search had a confusing sort order.  Corrected to sort by <code class="linecode">vendor_event_severity_level</code>.  Also, fixed the spelling of the Dashboard - previously started with <code class="linecode">Illuminate:*</code> and corrected to <code class="linecode">Illuminate:*</code></p>
            </li>
            <li>
                <p>Sysmon: add <code class="linecode">file_is_executable</code> extraction for Event ID 28 (1552)</p>
            </li>
            <li>
                <p>ASA dashboard has confusing severity levels (1559)</p>
            </li>
            <li>
                <p>Stormshield Bugfixes and Enhancement (1610)</p>
            </li>
            <li>
                <p>Updated bugfix rule to account for logs that contain a <code class="linecode">cat_site</code> AND <code class="linecode">arg</code> field. An existing Stormshield bug adds an extra quotation mark to the <code class="linecode">cat_site</code> field value which breaks parsing.</p>
            </li>
            <li>
                <p>Sysmon: Normalize Event Type to <code class="linecode">vendor_event_type</code> for all related Sysmon events (1576)</p>
            </li>
            <li>
                <p>Cisco ASA:Alert severity not assigned for some 338002 messages (1420)</p>
            </li>
            <li>
                <p>All dynamic filter messages 338001 to 338204 now get an alert severity even if the message does not have this field. Renamed field <code class="linecode">vendor_alert_severity1</code> to <code class="linecode">vendor_alert_severity</code></p>
            </li>
            <li>
                <p>Added check for previously identified messages to Checkpoint (1612)</p>
            </li>
            <li>
                <p>Illuminate: Added <code class="linecode">event_error_code</code> mapping as keyword (1674)</p>
                <p><b>NOTE</b>: This may cause a short-term mapping conflict in dashboards where mapping type are updated (such as with Palo Alto) but this conflict will resolve over time. Some products produce an error code as an integer value, some produce codes in other formats such as hex. This field is expected to be a keyword type, but implicit mappings result in mapping conflicts where integer values are mapped as type "long." The static mapping of <code class="linecode">event_error_code</code> as keyword will resolve this mapping conflict.</p>
            </li>
            <li>
                <p>Windows Security: Event 4663 not handled properly (803)</p>
            </li>
            <li>
                <p>Windows 4663 was categorized as a file change but 4663 can reflect changes to multiple components on a system in addition to the file system. Illuminate will now categorize a system based upon the component identified in event ID 4663.</p>
            </li>
            <li>
                <p>Sysmon extracting target process name incorrectly (1575)</p>
            </li>
            <li>
                <p>The field was being extracted incorrectly as <code class="linecode">target_process_name</code>, now extracting it as <code class="linecode">process_target_name</code></p>
            </li>
            <li>
                <p>Symantec Endpoint: Spotlight Alert destinations widget uses source fields (1679)</p>
            </li>
            <li>
                <p>Moved Cisco ASA identification rules from stage 2 to stage 5 (1613)</p>
            </li>
            <li>
                <p>Fortigate: fixed <code class="linecode">event_severity</code> &amp; <code class="linecode">event_severity_level</code> for informational and low (1642)</p>
            </li>
            <li>
                <p>The Fortigate event severity for informational events properly maps to a value  of 1 for <code class="linecode">event_severity_level</code> and informational for <code class="linecode">event_severity</code>.  Additionally, for  the notice Fortigate events, the <code class="linecode">event_severity_level</code> has been corrected with a value of 2 (low).</p>
            </li>
            <li>
                <p>Cisco ASA: Add support for user names with an @ in them. (1661)</p>
            </li>
            <li>
                <p> Checkpoint: Fixed processing of text for severity levels (1688)</p>
            </li>
        </ul>
        <h4>Added</h4>
        <ul>
            <li>
                <p>Added Ubiquiti UniFi Overview dashboard to go along with the existing Ubiquiti UniFi Illuminate pack. (1296)</p>
            </li>
            <li>
                <p>Added new technology pack NGINX Webserver (1207)</p>
            </li>
            <li>
                <p>This pack adds support for NGINX Webserver. It is tested with version 1.18/1.24 with the combined log format.</p>
            </li>
            <li>
                <p>Added Asset pack to Illuminate Security editions</p>
            </li>
            <li>
                <p>Adds the Asset processing pack needed to add the <code class="linecode">associated_assets</code> field to messages used by the Assets feature, available only in Graylog Security.</p>
            </li>
            <li>
                <p>Added support for Audit Security System Extension Windows events (216)</p>
            </li>
            <li>
                <p>Added support for additional Windows Security Event IDs 4610, 4611, 4614, 4622, 4697 which are enabled by the Audit Security System Extension policy in Windows. See <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-security-system-extension">https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/audit-security-system-extension</a> for additional information about these events.</p>
            </li>
            <li>
                <p>Core MITRE lookup that allows the mapping of technique UID to name (1622)</p>
            </li>
            <li>
                <p>Added a new core lookup that maps <code class="linecode">attacks_technique_uid</code> (MITRE ID) to <code class="linecode">attacks_technique_name</code> (MITRE name).  These are new fields.</p>
            </li>
            <li>
                <p>Updated Juniper documentation to include required input setting for proper processing (1569)</p>
            </li>
            <li>
                <p>Added full support for Cisco Firepower (1449)</p>
            </li>
            <li>
                <p>Adding full parsing for Cisco Firepower FTD events. Event IDs between 430001 and 430005 are now fully supported. This Illuminate pack will process the Cisco Firepower logs delivered to Graylog via Syslog and is not for use with the Cisco Firepower Event Streamer (eStreamer)/eNcore agents. The pack supports %FTD, %NGIPS, %NGFW (and %ASA) logs.</p>
            </li>
            <li>
                <p> Illuminate: The <code class="linecode">http_response_code</code> field now gets enriched. The new field <code class="linecode">http_response</code> describes the response code. (1633)</p>
            </li>
            <li>
                <p>Windows Security: Add access list enrichment (1644)</p>
            </li>
            <li>
                <p>Windows 4663 contains codes that reflect the types of accesses requested. Add an enrichment that will provide a plain text description of these access list codes in the field <code class="linecode">vendor_access_type</code>.</p>
            </li>
            <li>
                <p>CrowdStrike Falcon Technology Pack (1483)</p>
            </li>
            <li>
                <p>CrowdStrike Falcon technology pack release. Supports alerts and authentication events received by the CrowdStrike input, and includes a spotlight pack with an overview tab, authentication tab, and alert tab.</p>
            </li>
            <li>
                <p>Microsoft Defender for Endpoint Technology Pack (1540)</p>
            </li>
            <li>
                <p>Microsoft Defender for Endpoint technology pack release.  Supports 'alerts' events received by the Microsoft Defender for Endpoint Graylog input. Also adds a new core lookup that maps <code class="linecode">attacks_technique_uid</code> (MITRE ID) to <code class="linecode">attacks_technique_name</code> (MITRE name).  These are new fields.</p>
            </li>
        </ul>
        <h4>Changed</h4>
        <ul>
            <li>
                <p>GIM Enforcement:Change enforced source and destination fields for events categorized as network messages (1524)</p>
            </li>
            <li>
                <p>Reference fields (<code class="linecode">source_reference</code>, <code class="linecode">destination_reference</code>) are selected from a list of possible source fields such as <code class="linecode">source_ip</code>, <code class="linecode">destination_ip</code>, and <code class="linecode">source_hostname</code>. Defining the required fields for the network category to use these reference fields instead of only the IP fields will allow more messages to be categorized as network messages. Some sources will provide hostnames or mac addresses instead of IPs, changing the required field to use a reference field enables those messages to also be categorized as network messages.</p>
            </li>
            <li>
                <p>Core: Revised reference field processing (1685)</p>
            </li>
            <li>
                <p>Reference fields (<code class="linecode">host_reference</code>, <code class="linecode">source_reference</code>, <code class="linecode">destination_reference</code>) are now processed for any message with candidate fields and not just categorized messages. Any messages with source/host/destination IP, hostname, or MAC fields will now have associated reference fields added. For example, a message with <code class="linecode">host_ip</code>, <code class="linecode">host_hostname</code>, or <code class="linecode">host_mac </code>will have a  <code class="linecode">host_reference</code> field generated.</p>
            </li>
            <li>
                <p>Convert Illuminate Spotlight content IP fields to instead use reference fields (1673)</p>
            </li>
            <li>
                <p> Many existing Illuminate dashboards use the IP fields (<code class="linecode">source_ip</code>, <code class="linecode">destination_ip</code>, <code class="linecode">host_ip</code>) for aggregations but the use of fields with the IP mappings commonly run into aggregation errors. Converting the IP field use in aggregations to instead the "reference" fields (<code class="linecode">source_reference</code>, <code class="linecode">destination_reference</code>, <code class="linecode">host_reference</code>) will use keyword-mapped fields while retaining the ability to search the IP-based fields with CIDR functions and ranged searches, which will reduce the number of aggregations errors when viewing Illuminate content. Reference fields are selected from multiple potential fields (such as <code class="linecode">source_ip</code>, <code class="linecode">source_hostname</code>, <code class="linecode">source_mac</code>, and others) but will typically contain the original IP field data as that field as the IP field is typically the first choice selected when it exists.</p>
            </li>
            <li>
                <p>Converted <code class="linecode">gim_event_type_code</code> assignments to support multiple values (1504)</p>
            </li>
            <li>
                <p>The assignment of a `<code class="linecode">gim_event_type_code</code>` value has been limited to one value. With this change the `<code class="linecode">gim_event_type_code</code>` field is now a list of values and multiple codes can be assigned. This change requires Graylog 5.1.5 or greater.</p>
            </li>
            <li>
                <p>Rename original Microsoft Defender content to Microsoft Defender Antivirus (1654)</p>
            </li>
        </ul>
    </body>
</html>