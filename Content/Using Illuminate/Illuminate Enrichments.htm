<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Illuminate Enrichments</title>
    </head>
    <body>
        <MadCap:snippetBlock src="../Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Illuminate functionality includes enriching events with additional data that can help contextualize events. This is done throughout Illuminate, both in the core functionality and in many of the Illuminate processing packs. This article focuses on the enrichments added and used by Illuminate core.        </p>
        <p>Some of the lookups provided in Illuminate can be customized by the user, as detailed e<MadCap:annotation MadCap:createDate="2025-02-07T12:45:05.2348821-09:00" MadCap:creator="AnnieZempel" MadCap:initials="AN" MadCap:comment="revise" MadCap:editor="AnnieZempel" MadCap:editDate="2025-02-07T12:45:06.6522482-09:00">xplained in the descriptions of the lookups where it applies.</MadCap:annotation></p>
        <h2>Severity Mapping Enrichments</h2>
        <p>Event logs and alerts will often have a severity assigned. Sometimes this event is provided as a plain text severity, and sometimes it is provided as a numeric value. Severity mapping lookups are used to ensure that, where either the text or numeric value is the only value defined, that corresponding value will be defined.</p>
        <p>The severity mapping lookups included with Illuminate core:</p>
        <ul>
            <li><b>illuminate-mapping-alert-severity-to-level</b>: When a message includes an <code class="linecode">alert_severity</code> value but not an <code class="linecode">alert_severity_level</code> field, this mapping is used to define the level value.</li>
            <li><b>illuminate-mapping-level-to-alert-severity</b>: When a message includes an <code class="linecode">alert_severity_level</code> numeric value but not an <code class="linecode">alert_severity</code> value, this mapping is used to define the severity value.</li>
            <li><b>illuminate-mapping-event-severity-to-level</b>: When a message includes an <code class="linecode">event_severity</code> value but not an <code class="linecode">event_severity_level</code> field, this mapping is used to define the level value.</li>
            <li><b>illuminate-mapping-event-level-to-severity</b>: When a message includes an <code class="linecode">event_severity_level</code> numeric value but not an <code class="linecode">event_severity</code> value, this mapping is used to define the severity value.</li>
        </ul>
        <p>
            <section class="warningBox">
                <div class="title" style="font-weight: normal;"><b>Warning</b>:  These lookups should <b>not</b> be customized.</div>
            </section>
        </p>
        <h2>GIM Data Enrichment</h2>
        <p>This lookup takes the <code class="linecode">gim_event_type_code</code> value and defines the following fields:</p>
        <ul>
            <li><code class="linecode">gim_event_class</code>
            </li>
            <li><code class="linecode">gim_event_category</code>
            </li>
            <li><code class="linecode">gim_event_subcategory</code>
            </li>
            <li><code class="linecode">gim_event_type</code>
            </li>
        </ul>
        <p>
            <section class="warningBox">
                <div class="title" style="font-weight: normal;"><b>Warning</b>: The GIM event data mapping lookup is <code class="linecode">core_gim_data_lookup</code>. This lookup should <b>not</b> be customized.</div>
            </section>
        </p>
        <h2>Network Range Enrichment Lookup</h2>
        <p>Illuminate provides the ability to define category fields for source, destination, and host systems defined in logs. This enrichment will examine the fields <code class="linecode">source_ip</code>, <code class="linecode">destination_ip</code>, and <code class="linecode">host_ip</code>. If the IP address in those fields is in a range that has been added to the network ranges lookup, then any category values defined in that lookup will be assigned to the fields <code class="linecode">source_category</code>, <code class="linecode">destination_category</code>, or <code class="linecode">host_category</code>, respectively.</p>
        <p>After installing Graylog Illuminate and enabling any content pack, there will be a lookup added with a lookup adapter titled <code class="linecode">core_networks_adapter</code>. You can add entries to this lookup adapter and provide one or more category values that will be added to incoming logs.</p>
        <h3>Defining Categories for Hosts Based On Network Ranges</h3>
        <p>
            <section class="warningBox">
                <div class="title"><b>Warning</b>: <span style="font-weight: normal;">Use caution when adding lookup table customization entries for which you are modifying the intended lookup table adapter.</span></div>
            </section>
        </p>
        <ol>
            <li>Navigate to <i>Enterprise </i>&gt; <i>Illuminate</i> in the Graylog interface.</li>
            <li>Click on the <i>Customization</i> tab located on the top left-hand side of the  <i>Illuminate</i> page. Here you will see a list of Illuminate lookup adapters.</li>
            <li> Locate the lookup adapter named <code class="linecode">core_networks_lookup</code> and select the <i>Edit</i> button for the adapter, located to the right of the adapter entry. You will see an entry box with the key column titled <i>ip range</i> and a value column titled <i>ip category data</i>.</li>
            <li>Add a <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation">CIDR-notation formatted</a> IP range (both IPv4 and IPv6 are supported) in the <i>ip range</i> column.</li>
            <li>Add one or more category values, separating each category value with a pipe character (<code class="linecode">|</code>), in the <i>ip category data</i> column.</li>
        </ol>
        <p>We recommend using only alphanumeric characters and replacing spaces with a replacement character, such as an underscore (<code class="linecode">_</code>), to simplify searching for these category values.</p>
        <h2>HTTP Data Enrichment Adapters</h2>
        <p>These lookups will modify some common HTTP fields with useful data. There are two lookup adapters in this group:</p>
        <ol>
            <li><code class="linecode">lookup_http_class</code>
            </li>
            <li><code class="linecode">lookup_http_response</code>
            </li>
        </ol>
        <p>Illuminate will detect when the <code class="linecode">http_response_code</code> field is defined and enrich these events with two fields:</p>
        <ul>
            <li><code class="linecode">http_response_class</code>: The response class is based upon the first digit of the HTTP response (<a href="https://datatracker.ietf.org/doc/html/rfc2616#section-6.1.1">RFC2616#6.1.1</a>).</li>
            <li><code class="linecode">http_response</code>: The response phrase corresponds with the response code (<a href="https://datatracker.ietf.org/doc/html/rfc2616#section-6.1.1">RFC2616#6.1.1</a> and <a href="https://datatracker.ietf.org/doc/html/rfc6585">RFC6585</a>).</li>
        </ul>
        <h2>Network Protocol Enrichments</h2>
        <p>These lookups will enrich events based on the presence of fields associated with network-related event logs.</p>
        <h3>Network Protocols</h3>
        <p>Some network event sources will provide a numeric value representing the <a href="https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml">IANA-registered protocol number</a> (which should be assigned to the field <code class="linecode">network_iana_number</code>) but not the protocol name.
            This enrichment, using a lookup with the lookup adapter named <code class="linecode">core_iana_to_network_transport</code>, will identify when only <code class="linecode">network_iana_number</code> is defined and use it to determine the protocol name, which will be assigned to the field <code class="linecode">network_transport</code>.
        </p>
        <h3>Reserved/Non-Routable Address Identification</h3>
        <p>This lookup will inspect the key fields:</p>
        <ul>
            <li><code class="linecode">source_ip</code>
            </li>
            <li><code class="linecode">destination_ip</code>
            </li>
            <li><code class="linecode">host_ip</code>
            </li>
        </ul>
        <p>When any of these fields exist, a lookup with the adapter titled <code class="linecode">core_ip_processing_reserved_ip_ranges_adapter</code> will be used to identify the use of any reserved IP address ranges. The reserved ranges used are:</p>
        <table style="mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');" class="TableStyle-Alternate-Row-Color" cellspacing="21">
            <thead>
                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Range(s)</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Tag Suffixes</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                  192.168.0.0/16, 172.16.0.0/12, 10.0.0.0/8, <a href="https://www.rfc-editor.org/rfc/rfc1918">RFC1918</a></td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1"><![CDATA[
                  ]]><code class="linecode">reserved_ip</code>, <code class="linecode">rfc1918</code>, <code class="linecode">is_internal
</code><![CDATA[                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                  127.0.0.0/8, <a href="https://www.rfc-editor.org/rfc/rfc1122#page-31">RFC1122</a>: See section 3.2.1.3 regarding loopback addressing
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2"><code class="linecode">               reserved_ip</code>, <code class="linecode">is_internal</code>, <code class="linecode">is_loopback</code>, <code class="linecode">rfc1122</code><![CDATA[                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                  169.254.0.0/16, <a href="https://www.rfc-editor.org/rfc/rfc3927">RFC3927</a>: IPv4 link-local addressing (A.K.A. APIPA addressing)
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1"><![CDATA[
                  ]]><code class="linecode">reserved_ip</code>, <code class="linecode">is_internal</code>, <code class="linecode">rfc3297</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                  224.0.0.0/4, <a href="https://www.rfc-editor.org/rfc/rfc3171">RFC3171</a>: IPv4 Multicast addressing
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2"><![CDATA[
                  ]]><code class="linecode">multicast</code>, <code class="linecode">reserved_ip</code>, <code class="linecode">rfc3171
</code><![CDATA[                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                  fe80::/10, ff00::/8, ::1/128, ::/128, ::FFFF:0:0/96, <a href="https://www.rfc-editor.org/rfc/rfc4291.html#section-2.4">RFC4291</a>: See section 2.4, IPv6 Address Architecture
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1"><![CDATA[
                  ]]><code class="linecode">reserved_ip</code>, <code class="linecode">is_internal</code>, <code class="linecode">rfc4291</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                  fc00::/7, <a href="https://www.rfc-editor.org/rfc/rfc4193#section-3.1">RFC4193</a>: See section 3.1, IPv6 unique local unicast addressing
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2"><![CDATA[
                  ]]><code class="linecode">reserved_ip</code>, <code class="linecode">is_internal</code>, <code class="linecode">rfc4193</code><![CDATA[                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                  2002::/16, <a href="https://www.rfc-editor.org/rfc/rfc3056#section-2">RFC3056</a>: IPv6 encapsulation of IPv4
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1"><code class="linecode">                reserved_ip</code>, <code class="linecode">6_to_4</code>, <code class="linecode">rfc3056</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                  2001::/32, <a href="https://www.rfc-editor.org/rfc/rfc4380">RFC4380</a>: Teredo
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2"><code class="linecode">reserved_ip</code>, <code class="linecode">teredo</code>, <code class="linecode">rfc4380</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                  192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, <a href="https://www.rfc-editor.org/rfc/rfc5737">RFC5737</a>: IPv4 reserved address block for documentation
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1"><![CDATA[
                  ]]><code class="linecode">reserved_ip</code>, <code class="linecode">is_illegal</code>, <code class="linecode">rfc5737</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">
                  198.18.0.0/15, <a href="https://www.rfc-editor.org/rfc/rfc2544#appendix-C.2.2">RFC2544</a>: IPv4 reserved addresses for benchmark testing
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2"><![CDATA[
                  ]]><code class="linecode">reserved_ip</code>, <code class="linecode">is_internal</code>, <code class="linecode">rfc2544</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">
                  2001:db8::/32, <a href="https://www.rfc-editor.org/rfc/rfc3849">RFC3849</a>: IPv6 reserved address block for documentation
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1"><code class="linecode">                  reserved_ip</code>, <code class="linecode">is_illegal</code>, <code class="linecode">rfc3849</code><![CDATA[
                ]]></td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">
                  2001:10::/28, <a href="https://www.rfc-editor.org/rfc/rfc4843">RFC4843</a>: Orchid routing
                </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body2"><code class="linecode">                  reserved_ip</code>, <code class="linecode">rfc4843</code><![CDATA[
                ]]></td>
                </tr>
            </tbody>
        </table>
        <p>Illuminate will detect when an IP in one of the key fields is in scope for any of the identified ranges and add values to the <code class="linecode">gim_tags</code> field.
        The values added have some common values and some that are specific to the ranges, and these will be prefixed with the context of the key field for which Illuminate has identified.
        For example, if the value <code class="linecode">source_ip</code> value is the IP address <code class="linecode">192.0.2.10</code> , Illuminate will add the following values to the <code class="linecode">gim_tags</code> field:
        </p>
        <ul>
            <li><code class="linecode">source_reserved_ip</code>
            </li>
            <li><code class="linecode">source_is_illegal</code>
            </li>
            <li><code class="linecode">source_rfc5737</code>
            </li>
        </ul>
    </body>
</html>