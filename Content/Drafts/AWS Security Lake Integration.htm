<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
    </head>
    <body>
        <h1>AWS Security Lake Integration</h1>
        <p>Amazon Security Lake is a security data lake for aggregating and managing security log and event data.</p>
        <p>This integration ingests security logs stored in Amazon Security Lake into Graylog Amazon Security Lake: <a href="https://docs.aws.amazon.com/security-lake/latest/userguide/what-is-security-lake.html">Amazon Security Lake user guide</a>.</p>
        <h1>Prerequisites</h1>
        <p>To use the AWS Security Lake Input, users must have a valid AWS account with Amazon Security Lake enabled and an Amazon Security Lake subscriber with appropriate IAM role access. See <a href="https://docs.aws.amazon.com/security-lake/latest/userguide/getting-started.html">Getting started - Amazon Security Lake</a>.</p>
        <p>Your Graylog installation will then poll your AWS Security Lake data and ingest new logs into Graylog on a specified interval.</p>
        <h1>Security Lake Setup</h1>
        <ol>
            <li>
                <p>Create the <a href="https://docs.aws.amazon.com/security-lake/latest/userguide/getting-started.html#prerequisites">AmazonSecurityLakeMetaStoreManager</a> role in AWS Identity and Access Management (IAM).</p>
            </li>
            <li>
                <p>Create a <a href="https://docs.aws.amazon.com/security-lake/latest/userguide/getting-started.html#subscribe-data">Subscriber</a> in Amazon Security Lake Console</p>
            </li>
            <li>
                <p>In the <b>Logs and events sources</b>, you can select which data sources you want to enable for the subscriber. Below are the two options:</p>
            </li>
        </ol>
        <ul style="list-style-type: circle;">
            <li>
                <p>  All Logs and event sources - Gives access to all of the event and log sources.</p>
            </li>
            <li>
                <p>Specific log and event sources - Gives access to only the specific sources you select from the available sources. </p>
            </li>
        </ul>
        <h1>Plugin Configuration:</h1>
        <p><b>Input Name</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>A unique name for your new Input.</p>
            </li>
        </ul>
        <p><b>AWS Access Key Id</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>The Access Key ID for the IAM user with permission to the subscriber and the SQS queue.</p>
            </li>
        </ul>
        <p><b>AWS Secret Access Key</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>The unique identifier created for the IAM user.</p>
            </li>
        </ul>
        <p><b>Security Lake Region</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>The Security Lake region where the subscriber is created.</p>
            </li>
        </ul>
        <p><b>SQS Queue Name</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>The SQS queue name created by the Security Lake Subscriber.</p>
            </li>
        </ul>
        <p><b>Enable Throttling</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>Enables Graylog to stop reading new data for this input whenever the system falls behind on message processing and needs to catch up.</p>
            </li>
        </ul>
        <p><b>Store Full Message</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>Permits Graylog to store the raw log data in the<code class="linecode"> full_message</code> field for each log message.</p>
            </li>
            <li>
                <p>Selection can result in a significant increase in the amount of data stored.</p>
            </li>
        </ul>
        <h1>Supported Logs and Event Sources:</h1>
        <p>This input currently supports some top level field parsing of the 4 event sources below. All other data can be manually parsed from the full_message field.</p>
        <p><b>CloudTrail</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>User activity and API usage in AWS services.</p>
            </li>
        </ul>
        <p><b>VPC flow logs</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>Details about IP traffic to and from network interfaces in your VPC.</p>
            </li>
        </ul>
        <p><b>Route 53</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>DNS queries made by resources within your Amazon Virtual Private Cloud (Amazon VPC).</p>
            </li>
        </ul>
        <p><b>Security Hub findings</b>
        </p>
        <ul style="list-style-type: circle;">
            <li>
                <p>Amazon Security findings from the Security Hub.</p>
            </li>
        </ul>
    </body>
</html>