<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Sophos Central Content Pack</title>
        <link href="Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <MadCap:snippetBlock src="../Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Sophos Central is a cloud-based unified security management platform that delivers centralized administration, threat detection, and policy enforcement across a range of security services encompassing network, endpoint, server, mobile, and email security. This content pack extracts fields from Sophos Central Endpoint Protection telemetry and event messages and normalizes them to align with the Graylog schema.</p>
        <h2>Supported Version(s)</h2>
        <p>Sophos Central is a continuously updated managed service that does not feature version numbers. This pack was built and tested for integration with the Sophos Central SIEM Integration v1 API. In addition, parsing is designed around Sophos Central events sourced from Windows endpoints. Events from other OS platforms such as macOS may be supported, but not fully tested.</p>
        <h2>Requirements</h2>
        <ul>
            <li>
                <p>Graylog 6.2.0+ with a valid Enterprise license</p>
            </li>
            <li>
                <p>Sophos Endpoint agent installed on client hosts with Endpoint Protection policies enabled</p>
            </li>
            <li>
                <p>Sophos Central API credentials created for use with the Graylog Sophos Central input</p>
            </li>
        </ul>
        <h2 id="what-is-provided">What is Provided</h2>
        <ul>
            <li>
                <p>Extraction of fields, normalization, and enrichment of Sophos Central Endpoint Protection event logs</p>
            </li>
            <li>
                <p>A dashboard for monitoring threat detections and affected endpoints</p>
            </li>
        </ul>
        <h2>Stream Configuration</h2>
        <p>This technology pack includes one stream:</p>
        <ul>
            <li>
                <p>"Illuminate:Sophos Messages"</p>
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title" style="font-weight: normal;"><b>Hint</b>:  If this stream does not exist prior to the activation of this pack then it will be created and configured to route messages to this stream and the associated index set. There should not be any stream rules configured for this stream.</div>
            </section>
        </p>
        <h2>Index Set Configuration</h2>
        <p>This technology pack includes one index set definition:</p>
        <ul>
            <li>
                <p>"Sophos Device Log Messages"</p>
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title" style="font-weight: normal;"><b>Hint</b>:  If this index set is already defined, then nothing will be changed. If this index set does not exist, then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.</div>
            </section>
        </p>
        <h2>Log Collection</h2>
        <p>The <a href="https://go2docs.graylog.org/current/getting_in_log_data/sophos_central_input.htm">Sophos Central input</a>  can be configured to securely access the Sophos Central SIEM Integration API for log data retrieval.</p>
        <h3>Configuring a Sophos Central Input</h3>
        <p>For Graylog to access Sophos Central logs via API, it needs API credentials:</p>
        <ol>
            <li>
                <p>Create API credentials in Sophos Central Admin. The assigned role should have read capabilities and access to queries, such as <i>Service Principal Super Admin</i>. A guide can be found <a href="https://docs.sophos.com/central/customer/help/en-us/ManageYourProducts/GlobalSettings/APICredentials/index.html">here</a>.</p>
            </li>
            <li>
                <p>Copy the generated Client ID and Client Secret and store them securely.</p>
            </li>
            <li>
                <p>Launch a Sophos Central input in Graylog. When prompted, provide the previously obtained Sophos Client ID and Secret.</p>
            </li>
            <li>
                <p>Optionally configure the following input options:</p>
                <ul>
                    <li>
                        <p><b>Ingest Alerts</b>: Whether to ingest Sophos alerts in addition to events.</p>
                    </li>
                    <li>
                        <p><b>Polling Interval</b>: How often (in minutes) the input will check for new log data, recommended to leave at default 5 minutes.</p>
                    </li>
                    <li>
                        <p><b>Enable Throttling</b>: If enabled, it will stop reading new data for this input whenever the system falls behind on message processing and needs to catch up.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Save the input settings.</p>
            </li>
        </ol>
        <p>If the input does not start automatically, select <i>Start Input</i> to begin retrieving and processing messages from the configured Sophos Central server.</p>
        <p>
            <section class="infoBox">
                <div class="content"><b>Hint:</b> This pack rewrites the message field to reduce license utilization. To get the full message, set <i>Store full message</i> in the input settings to true.</div>
            </section>
        </p>
        <h2>Log Format Example</h2>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">{"type":"Event::Endpoint::CoreDetection","origin":"SAV","created_at":"2025-01-24T11:32:22.544Z","source_info":{"ip":"192.168.40.176"},"customer_id":"aabbccdd-1234-5678-abcd-ef1234567890","severity":"medium","endpoint_id":"10a1a0aa-aa10-10aa-1010-a01a1aaa01a0","endpoint_type":"computer","user_id":"671565c8eeddce2b21c52a24","threat":"Mal/Kryptik-DL","when":"2025-01-24T11:32:11.870Z","appSha256":"43670ae43df9e361fa15f09f611da32db104ee207ed5af3e7e7f098ad82a68e0","source":"DESKTOP-JDVP7LN\Test234","location":"DESKTOP-JDVP7LN","id":"cc29ad5d-3e42-20da-8790-03f87f291fa6","group":"MALWARE","name":"Malware detected: 'Mal/Kryptik-DL' at 'C:\Users\Test234\Downloads\43670ae43df9e361fa15f09f611da32db104ee207ed5af3e7e7f098ad82a68e0'"}
            </MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <h2 id="events-processed-by-this-technology-pack">Event Groups Processed</h2>
        <p>Logs from event groups not included will have generic processing applied:</p>
        <ul>
            <li>
                <p><code class="linecode">APPLICATION_CONTROL</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">DATA_LOSS_PREVENTION</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">DENC</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">MALWARE</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">PERIPHERALS</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">PROTECTION</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">PUA</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">SYSTEM_HEALTH</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">UPDATING</code>
                </p>
            </li>
            <li>
                <p><code class="linecode">WEB</code>
                </p>
            </li>
        </ul>
        <h2>Sophos Central Spotlight Content Pack</h2>
        <h3>Overview</h3>
        <p>
            <img src="../Resources/Images/Sophos Central Content Pack/overview.png" />
        </p>
        <h3>Threat Events</h3>
        <p>
            <img src="../Resources/Images/Sophos Central Content Pack/threat_events.png" />
        </p>
        <p>
            <img src="../Resources/Images/Sophos Central Content Pack/hostname.png" />
        </p>
    </body>
</html>