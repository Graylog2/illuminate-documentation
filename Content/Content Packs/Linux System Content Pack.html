<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Linux System Content Pack</title>
        <link href="Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <MadCap:snippetBlock src="Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Linux is a ubiquitous, open-source operating system that powers everything from servers and cloud infrastructure to desktop systems and embedded devices.
            For its initial release, this technology pack provides common log parsing, normalization and enrichment for Debian/Ubuntu Linux distributions.
        </p>
        <h2>Supported Distributions</h2>
        <ul>
            <li>Ubuntu 20.04 LTS (Focal Fossa) and 22.04 LTS (Jammy Jellyfish)
            </li>
            <li>Debian 11 (bullseye) and 12 (bookworm)
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title" style="font-weight: normal;"><b>Note</b>:  While the initial release of this pack was primarily developed and tested on Ubuntu, it also supports Debian as Ubuntu is based on Debian.
                    Both distributions share similar log formats for common system outputs like syslog and auth.log.
                    Minor differences in service naming or security frameworks may exist, but the core log structures are compatible across both platforms.
                </div>
            </section>
        </p>
        <h2>Requirements</h2>
        <ul>
            <li>Minimum of Graylog 6.0.1 with a valid Enterprise license
            </li>
        </ul>
        <h2>Stream Configuration</h2>
        <p>This technology pack includes one stream:</p>
        <ul>
            <li>Illuminate:Linux System Messages
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title" style="font-weight: normal;"><b>Note</b>:  If this stream does not exist prior to the activation of this pack then it will be created and
                    configured to route messages to this stream and the associated index set.There should not be any stream rules configured for this stream.
                </div>
            </section>
        </p>
        <h2>Index Set Configuration</h2>
        <p>This technology pack includes one index set definition:</p>
        <ul>
            <li>Linux System Logs
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title" style="font-weight: normal;"><b>Note</b>:  If this index set is already defined, then nothing will be changed. If this index set does not exist,
                    then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.
                </div>
            </section>
        </p>
        <h2>Log Collection</h2>
        <p>This pack primarily parses logs written to syslog and auth.log under the /var/log directory.
            The following log forwarders are recommended:
        </p>
        <ul>
            <li>Rsyslog
            </li>
            <li>Filebeat (with Graylog Sidecar)
            </li>
        </ul>
        <h3>Rsyslog Configuration</h3>
        <ol>
            <li>
                <p>Create a matching <a href="https://go2docs.graylog.org/current/getting_in_log_data/syslog_inputs.html">syslog input</a> in Graylog.</p>
            </li>
            <li>
                <p>Configure rsyslog to send logs under <code class="linecode">/var/log</code> to Graylog.
                    You can specifically forward messages from syslog and auth.log as the pack primarily targets these log sources.</p>
            </li>
            <li>
                <p>Create a custom template that identifies the logs as Linux logs for the parser to recognize.
                    The simplest method is to set the field <code class="linecode">event_source_product</code> as "linux" in the structured data
                    portion of the syslog message. See the following example template configuration:
                </p>
            </li>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">
template(name="Custom_Linux_SyslogProtocol23Format" type="string" string="<%PRI%>1 %TIMESTAMP:::date-rfc3339% %HOSTNAME% %APP-NAME% %PROCID% %MSGID% [origin event_source_product=\"linux\"] %MSG%\n")

*.* action(type="omfwd" target="YOUR GRAYLOG SERVER" port="514" protocol="udp" template="Custom_Linux_SyslogProtocol23Format")
            </MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
            </ol>
        <p>
            <section class="infoBox">
                <div class="title" style="font-weight: normal;"><b>Note</b>:  Only <a href="https://www.ietf.org/rfc/rfc5424.txt">RFC 5424</a> compliant syslog messages are accepted.</div>
            </section>
        </p>
        <h3>Filebeat Configuration</h3>
        <p>Please refer to the <a href="https://go2docs.graylog.org/current/getting_in_log_data/graylog_sidecar.html">official documentation</a> to setup Graylog Sidecar for Filebeat.</p>
        <ol>
            <li>
                <p>Create a matching <a href="https://go2docs.graylog.org/current/getting_in_log_data/beats_input.html">Beats input</a> in Graylog.
                    Ensure that the option "Do not add Beats type as prefix" is disabled.
                </p>
            </li>
            <li>
                <p>Create an API access token and custom Linux Filebeat collector.</p>
            </li>
            <li>
                <p>Configure the collector to ship messages in syslog and auth.log to Graylog. The Filebeat input must add the field <code class="linecode">event_source_product: linux</code> for the parser to identify the log source as Linux.
                    In addition, the option <code class="linecode">fields_under_root</code> must be set to <code class="linecode">true</code> for message identification to work. See the following example snippet:
                </p>
            </li>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="False" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve">filebeat.inputs:
- input_type: log
  paths:
    - /var/log/auth.log
    - /var/log/syslog
  type: filestream
  fields_under_root: true
  fields:
    event_source_product: linux</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
            <li>
                <p>Install Graylog Sidecar on the client host.</p>
            </li>
            <li>
                <p>Edit the Graylog Sidecar client configuration with your Graylog server API URL and API access token.</p>
            </li>
        </ol>
        <h2 id="what-is-provided">What is Provided</h2>
        <ul>
            <li>
                <p>
                    Rules to parse, normalize and enrich Linux system log messages
                </p>
            </li>
            <li>
                <p>
                    A dashboard displaying events and statistics of interest
                </p>
            </li>
        </ul>
        <h2 id="events-processed-by-this-technology-pack">Events Processed by This Technology Pack</h2>
        <p>The Google Workspace content pack supports the following logs types.  Generic processing will be provided for log types not listed.</p>
        <h2 id="packetbeat-spotlight-content-pack">Linux System Spotlight Content Pack</h2>
        <p>The Linux System Spotlight Content Pack offers a dashboard with 4 tabs:</p>
        <ul>
            <li>
                <p>Linux System Overview</p>
            </li>
        </ul>
        <p>
            <img src="../Resources/Images/Google Workspace/gw_overview.png">
        </p>
        <ul>
            <li>
                <p>SSH</p>
            </li>
        </ul>
        <p>
            <img src="../Resources/Images/Google Workspace/gw_gmail1.png">
        </p>
        <ul>
            <li>
                <p>Sudo</p>
            </li>
        </ul>
        <p>
            <img src="../Resources/Images/Google Workspace/gw_saved_search.png">
        </p>
        <ul>
            <li>
                <p>Users and Groups</p>
            </li>
        </ul>
        <p>
            <img src="../Resources/Images/Google Workspace/gw_saved_search.png">
        </p>
    </body>
</html>