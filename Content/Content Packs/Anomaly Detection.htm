<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Anomaly Detection Content Pack</title>
        <link href="Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <MadCap:snippetBlock src="Resources/Snippets/IlluminateBanner.flsnp" />
        <p><span style="background-color: #ffff00;">The Anomaly Detection Add-on technology pack, and the associated Anomaly Detection Spotlight, provide useful components that are required when taking advantage of the Anomaly Detection feature in Graylog Security. The Anomaly Detection Spotlight provides predefined anomaly detection rules that can be used in conjunction with different Illuminate packs.</span>
        </p>
        <h2>Supported Version(s)</h2>
        <ul>
            <li><span style="background-color: #ffff00;">Graylog Security 5.2.0+</span>
            </li>
        </ul>
        <h2>Requirements</h2>
        <ul>
            <li><span style="background-color: #ffff00;">A Valid Graylog Security license</span>
            </li>
        </ul>
        <h2><span style="background-color: #ffff00;">Anomaly Detection</span> Add-on</h2>
        <p>The anomaly detection add-on provides the stream and index set for anomaly detection rules, and is required to utilize the anomaly detection rules that are provided in the Anomaly Detection Spotlight. The add-on should be enabled if you are utilizing the anomaly detection feature, even if you are not using the anomaly detection rules provided by the Illuminate Anomaly Detection Spotlight. </p>
        <h3>Anomaly Feature Fields</h3>
        <p>The Anomaly Detection Add-on includes pipelines which will add feature fields used by the anomaly detection rules included in the Anomaly Detection Spotlight. These are usually product-specific fields which indicate a specific type of event has occurred, such as a failed logon, with field names that begin with the prefix <code class="linecode">anomdet_</code>.</p>
        <h3>Stream Configuration</h3>
        <p>This technology pack includes <span style="background-color: #ffff00;">one</span> stream:</p>
        <ul>
            <li><span style="background-color: #ffff00;">Graylog Anomaly Detection Messages</span>
            </li>
        </ul>
        <h3>Index Set Configuration</h3>
        <p>This technology pack includes <span style="background-color: #ffff00;">one</span> index set definition:</p>
        <ul>
            <li><span style="background-color: #ffff00;">Graylog Anomaly Detection Messages</span>
            </li>
        </ul>
        <h2><span style="background-color: #ffff00;">Anomaly Detection</span> Spotlight Content Pack</h2>
        <h2>Anomaly Detection Rules</h2>
        <!-- Insert table of updated anomaly detection rules and descriptions here -->
        <p><span style="background-color: #ffff00;">The Anomaly Detection Spotlight</span> provides pre-defined anomaly detection rules designed to work with the existing Illuminate processing packs.</p>
        <h2 id="anomaly-detection-rule-updates">Anomaly Detection Rule Updates</h2>
        <p>
            <section class="warningBox">
                <div class="title"><b>Warning</b>:<span style="font-weight: normal;"> Read the full instructions prior to updating the Anomaly Detection rules</span></div>
            </section><br>
            Illuminate 5.2.0 and later include a new Anomaly Detection Spotlight pack which contains updated versions of the rules previously included in Illuminate versions prior to Illuminate 5.2.0.
            The previous Anomaly Detection Spotlight pack has been renamed to "Core:Anomaly Detection Spotlight (Legacy)" and the updated rules are in the Illuminate pack titled "Core:Anomaly Detection Spotlight".
            <h3>Updating the Anomaly Detection Rules</h3>
            If you have enabled and are running any of the anomaly detection rules from versions of Illuminate prior to Illuminate 5.2.0:
            <ol>
                <li>Navigate to the Illuminate installer page under the Enterprise menu of your Graylog Server web interface</li>
                <li>Download and install the most recent version of Illuminate if you have not already</li>
                <li>Enable the Illuminate pack Core:Anomaly Detection Spotlight <span style="background-color: #ffff00;">but do not disable the "Core:Anomaly Detection Spotlight (Legacy)" pack</span></li>
                <li>Navigate to the "Anomalies" page under the "Security" menu of your Graylog Server web interface </li>
                <li>Note that a new set of anomaly detection rules are listed</li>
                <li>Record which anomaly detection rules are currently running</li>
                <li>Refer to the updated rules list below to determine which updated rule corresponds with each legacy rules</li>
                <li>One rule at a time, for each currently running legacy rule:</li>
                <ol type="a">
                    <li>Enable the updated version of the corresponding rule</li>
                    <li>Wait for the newly enabled rule to complete training - at least 24 hours</li>
                    <li>Disable the legacy rule(s) - Some updated single rules replace multiple legacy rules</li>
                    <li>Repeat this process until all of the legacy anomaly detection rules have been updated and disabled</li>
                </ol>
                <li>After all of the updated legacy rules have been disabled and the corresponding updated rules enabled return to the Illuminate installer page and disable the pack <span style="background-color: #ffff00;">"Core:Anomaly Detection Spotlight (Legacy)"</span></li>
            </ol>
            <h3>Updated Rules List</h3>
            <p>The list of updated anomaly detection rules and which rules they replace:<br>
            <!-- Insert table of legacy and updated anomaly detection rules here -->
            </p>
        </p>
    </body>
</html>