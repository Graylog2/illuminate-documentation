<?xml version="1.0" encoding="utf-8"?>
<html lang="en" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" /><title> Office 365 Content Pack
</title>
        <!-- original-url : office-365
## article-id : df5d8ab5-d71d-4440-9cbe-d5861788e663
## seo-title : Office 365
## description : 
## Metadata_End -->
    </head>
    <body>
        <MadCap:snippetBlock src="../Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Microsoft’s Office 365 provides cloud-based office apps like Word, Excel, and others. O365 Spotlight for Graylog Illuminate works with the Office 365 Log Events Enterprise Plugin to process Microsoft Office 365 logs by providing normalization and enrichment of common events. The Spotlight comes ready to use with several pre-built dashboard views including O365 Overview and tabs for Exchange, Azure Active Directory, and other O365 applications.</p>
        <h2>Supported Version(s)</h2>
        <ul>
            <li>Current version of O365 as supported by Microsoft and the Graylog Office 365 Log Events Enterprise Plugin.</li>
        </ul>
        <h2>Stream Configuration</h2>
        <p>This technology pack includes one stream:</p>
        <ul>
            <li>“Illuminate:O365 Messages”</li>
        </ul>
        <p>If this stream name is already defined, then nothing will be changed. If this stream name does not exist, then it will be created.</p>
        <h2>Index Set Configuration</h2>
        <p>This technology pack includes one index set definition:</p>
        <ul>
            <li>“Microsoft Office365 Event Log Messages”</li>
        </ul>
        <p>If this index set is already defined, then nothing will be changed. If this index set does not exist, then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.</p>
        <h2>Log Format Example</h2>
        <p><code data-backticks="1" class="linecode">{"CreationTime":"2021-10-03T00:14:46","Id":"bee3fdad-4243-8f3b-f234-15c294843741","Operation":"SearchMtpStatus","OrganizationId":"bee3fdad-4243-8f3b-f234-15c294843742","RecordType":52,"UserKey":"NOT-FOUND","UserType":5,"Version":1,"Workload":"SecurityComplianceCenter","UserId":"NOT-FOUND","AadAppId":"bee3fdad-4243-8f3b-f234-15c294843740","DataType":"MtpStatus","DatabaseType":"DataInsights","RelativeUrl":"/DataInsights/DataInsightsService.svc/Find/MtpStatus?tenantid=bee3fdad-4243-8f3b-f234-15c294843743","ResultCount":"1"}</code>
        </p>
        <h2>Requirements</h2>
        <ul>
            <li>
                <p>A configured Azure / Office 365 tenant and API keys as detailed at: /en/4.0/pages/integrations/inputs/o365_input.html</p>
            </li>
            <li>
                <p>A configured Graylog O365 input (see “Configuring an O365 Input” below).</p>
            </li>
        </ul>
        <h2>What is Provided</h2>
        <ul>
            <li>
                <p>Parsing rules to extract 0365 logs into Graylog schema compatible fields.</p>
            </li>
            <li>
                <p>Dashboards</p>
            </li>
            <li>
                <p>Data lookup tables to assist in normalizing 0365 log messages into the Graylog schema</p>
            </li>
        </ul>
        <h2>Configuring an O365 Input</h2>
        <ol>
            <li>On the <em>Select Input</em> drop-down menu, select <em>System</em> menu and then choose <em>Inputs</em>.</li>
            <li>Select <em>Office 365 Log Events</em> from the <em>Select Input</em> drop-down menu.</li>
            <li>Click <em>Launch New Input</em>.</li>
            <li>Assign a node or select Global mode.</li>
            <li>Set the Title, Directory (tenant) ID, Application (client) ID, Client Secret, and Subscription Type to correct values for your O365 tenant.</li>
            <li>Click <em>Verify Connection &amp; Proceed</em>.</li>
            <li>Specify the desired Content Types. Options include: AZURE_ACTIVE_DIRECTORY, SHAREPOINT, EXCHANGE, GENERAL, and DLP_ALL.</li>
            <li>Set the polling interval. (Graylog recommends starting with a polling interval of 3 minutes for the System Log API used by the Graylog O365 Log Events plugin.)</li>
            <li><em>This step is optional</em>: Select <em>Store Full Message</em>. (This option consumes additional Graylog ingestion volume and storage requirements but may be required for compliance or other reasons.)</li>
            <li>Save the input settings.</li>
            <li>If the input does not start automatically, select <em>Start Input</em> to begin retrieving and processing messages from the configured O365 tenant.</li>
        </ol>
    </body>
</html>