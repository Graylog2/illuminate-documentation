<?xml version="1.0" encoding="utf-8"?>
<html lang="en" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" /><title> Google Workspace Content Pack
</title>
        <!-- original-url : fortigate
## article-id : bb1e7a3a-7951-49f2-ac76-6ff700066f0f
## seo-title : Fortigate
## description : 
## Metadata_End -->
    </head>
    <body>
        <MadCap:snippetBlock src="../Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Google Workspace is a collection of cloud computing, productivity and collaboration tools, software, and products developed and marketed by Google. It consists of Gmail, Google Contacts, Google Calendar, Google Meet, Google Chat, Google Drive, Google Docs, and more.</p>
        <h2>Requirement(s)</h2>
        <ul>
            <li>
                <p>Minimum of Graylog 6.1 with a valid Enterprise license</p>
            </li>
            <li>
                <p>Google Workspace subscription</p>
            </li>
            <li>
                <p>Google Cloud subscription</p>
            </li>
        </ul>
        <h2>Stream Configuration</h2>
        <p>This technology pack includes one stream:</p>
        <ul>
            <li>“Illuminate:Google Workspace Messages”</li>
        </ul>
        <section class="infoBox">
            <div class="content">
                <p><b>Hint:</b>&#160;If this stream does not exist prior to the activation of this pack then it will be created and configured to route messages to this stream and the associated index set. There should not be any stream rules configured for this stream.</p>
            </div>
        </section>
        <h2>Index Set Configuration</h2>
        <p>This technology pack includes one index set definition:</p>
        <ul>
            <li>“Google Workspace Logs”</li>
        </ul>
        <section class="infoBox">
            <div class="content">
                <p><b>Hint:</b> If this index set is already defined, then nothing will be changed. If this index set does not exist, then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.</p>
            </div>
        </section>
        <h2>Log Collection</h2>
        <p>Google Workspace unitizes <a href="https://go2docs.graylog.org/current/getting_in_log_data/google_workspace_input.htm">the  Google Workspace input</a> that ingests multiple Google product type logs in JSON format.</p>
        <h2>Configuration Example</h2>
        <p>See the input documentation for configuration details.</p>
        <p>
            <img src="../Resources/Images/Google Workspace Content Pack/gw_input.png" />
        </p>
        <h2>Log Format Example</h2>
        <p><code data-backticks="1" class="linecode">{"time_usec":1724603503674757,"email":"somebody@somewhere.com","group_id":[],"org_unit_name_path":["Org Name"],"ip_address":"ABCDEFGHIJKLMNOPQR==","event_type":"delivery_type","event_name":"delivery","record_type":"gmail","has_sensitive_content":false,"unique_identifier":"-1294059893469656048","event_id":"b6c2d1fb","resource_ids":[],"resource_details":[],"gmail":{"event_info":{"timestamp_usec":1724603503674757,"elapsed_time_usec":1660649,"success":true,"mail_event_type":2},"message_info":{"action_type":3,"rfc2822_message_id":"&lt;111273729@google.com&gt;","subject":"Spotty connection? No worries. Work offline","payload_size":40973,"source":{"address":"googleworkspace-noreply@google.com","service":"smtp-inbound","from_header_address":"googleworkspace-noreply@google.com","from_header_displayname":"Google Workspace Team"},"destination":[{"address":"somebody@somewhere.com","service":"gmail-ui","selector":""}],"flattened_destinations":"gmail-ui::somebody@somewhere.com","description":"No Error","is_spam":false,"is_policy_check_for_sender":false,"num_message_attachments":0,"attachment":[],"connection_info":{"client_ip":"192.168.1.1","failed_smtp_out_connect_ip":[],"smtp_tls_state":1,"smtp_reply_code":0,"smtp_user_agent_ip":"192.168.1.1","is_intra_domain":false,"dmarc_pass":true,"dmarc_published_domain":"google.com","client_host_zone":"google.com","ip_geo_country":"US","authenticated_domain":[{"name":"google.com","type":2},{"name":"scoutcamp.bounces.google.com","type":6},{"name":"scoutcamp.bounces.google.com","type":1}],"is_internal":false,"dkim_pass":true,"spf_pass":true},"message_set":[{"type":9},{"type":15},{"type":1}],"triggered_rule_info":[],"smime_content_type":0,"link_domain":["google.com","w3.org"],"spam_info":{"disposition":1,"classification_reason":1,"ip_whitelist_entry":""}}}}</code>
        </p>
        <h2>What is Provided</h2>
        <ul>
            <li>
                <p>Rules to normalize and enrich Google Workspace log messages, a dashboard, and saved search.</p>
            </li>
        </ul>
        <h2>Events Processed by This Technology Pack</h2>
        <p>The Google Workspace content pack supports the following logs types.  Generic processing will be provided for log types not listed.</p>
        <ul>
            <li>
                <p>Gmail Logs</p>
            </li>
            <li>
                <p>Chat Logs</p>
            </li>
            <li>
                <p>Calendar Logs</p>
            </li>
            <li>
                <p>Drive Logs</p>
            </li>
            <li>
                <p>Mobile Logs</p>
            </li>
            <li>
                <p>Token Logs</p>
            </li>
            <li>
                <p>Login Logs</p>
            </li>
        </ul>
        <h2>GIM&#160;Categorization</h2>
        <p>GIM categorization of the following messages:</p>
        <table style="width: 100%;mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');" class="TableStyle-Alternate-Row-Color" cellspacing="21">
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" style="width: 256px;" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" style="width: 221px;" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" style="width: 205px;" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <thead>
                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Vender Event Description</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">GIM&#160;Category</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">GIM&#160;Subcategory</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">GIM&#160;Event Type Code</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Message sent</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1"><code class="linecode">messaging</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1"><code class="linecode">messaging.email</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">130000</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Message received</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2"><code class="linecode">messaging</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2"><code class="linecode">messaging.default</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">139999</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Message permanently deleted</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1"><code class="linecode">messaging</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1"><code class="linecode">messaging.email</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">132000</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">Message quarantined</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2"><code class="linecode">messaging</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2"><code class="linecode">messaging.email</code>
                    </td>
                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body2">131500</td>
                </tr>
            </tbody>
        </table>
        <h2>Google Workspace Spotlight Content Pack</h2>
        <p>Google Workspace Spotlight Content Pack offers a dashboard with two tabs, Google Workspace Overview and Gmail, and a parameter based saved search for information associated with a user e-mail address.</p>
        <h3>Google Workspace Overview</h3>
        <p>
            <img src="../Resources/Images/Google Workspace Content Pack/gw_overview_main.png" />
        </p>
        <h3>Gmail</h3>
        <p>
            <img src="../Resources/Images/Google Workspace Content Pack/gw_gmail1.png" />
        </p>
        <p>
            <img src="../Resources/Images/Google Workspace Content Pack/gw_gmail2.png" />
        </p>
        <h3>Google Workspace User Search</h3>
        <p>
            <img src="../Resources/Images/Google Workspace Content Pack/gw_saved_search.png" />
        </p>
    </body>
</html>