<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>Cloudflare Content Pack</title>
    </head>
    <body>
        <p>Cloudflare is a comprehensive cloud web-based security and performance platform that works by filtering out malicious traffic, preventing cyberattacks like DDoS, and optimizing content delivery to ensure faster loading times for users.</p>
        <p>This technology pack will process Cloudflare logs, providing normalization and enrichment of those events.</p>
        <h2 class="Heading2">Supported Version(s)</h2>
        <ul>
            <li>
                <p class="NormalWeb">Cloudflare 2024.10.2 </p>
            </li>
        </ul>
        <h2>Stream Configuration</h2>
        <p>This technology pack includes one stream:</p>
        <ul>
            <li>
                <p>"Illuminate: Cloudflare Falcon Messages"</p>
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title"><strong>Hint: </strong><span style="font-weight: normal;">If this stream does not exist prior to the activation of this pack, then it will be created and configured to route messages to this stream and the associated index set. There should not be any stream rules configured for this stream.</span>
                </div>
            </section>
        </p>
        <h2>Index Set Configuration</h2>
        <p>This technology pack includes one index set definition:</p>
        <ul>
            <li>"Cloudflare: Falcon Event Log Messages"</li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title"><strong>Hint: </strong><span style="font-weight: normal;">If this index set is already defined, then nothing will be changed. If this index set does not exist, then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.</span>
                </div>
            </section>
        </p>
        <h2>Log Collection</h2>
        <p>Users can leverage <a href="https://go2docs.graylog.org/current/getting_in_log_data/raw_http_input.htm">Graylog's Raw HTTP input</a> to receive logs directly from Cloudflare via its Logpush functionality. By configuring Logpush, users can define which types of logs to send (e.g. HTTP requests, firewall events) and specify Graylog as the destination endpoint. This allows seamless log forwarding from Cloudflare to Graylog for centralized log analysis. For detailed instructions please refer to <a href="https://go2docs.graylog.org/current/getting_in_log_data/cloudflare_logpush_with_raw_http_input.htm">the Graylog documentation on setting up Logpush with the Raw HTTP&#160;input</a>.</p>
        <h2>Log Format Example</h2>
        <p><code class="linecode">{"Action":"log","ClientASN":209,"ClientASNDescription":"CENTURYLINK-US-LEGACY-QWEST","ClientCountry":"us","ClientIP":"205.186.39.189","ClientIPClass":"noRecord","ClientRefererHost":"","ClientRefererPath":"","ClientRefererQuery":"","ClientRefererScheme":"","ClientRequestHost":"cloudtest.life","ClientRequestMethod":"GET","ClientRequestPath":"/","ClientRequestProtocol":"HTTP/1.1","ClientRequestQuery":"","ClientRequestScheme":"http","ClientRequestUserAgent":"Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36","ContentScanObjResults":[],"ContentScanObjSizes":[],"ContentScanObjTypes":[],"Datetime":"2024-10-16T14:03:41Z","Description":"Test_WAF","EdgeColoCode":"DFW","EdgeResponseStatus":404,"Kind":"firewall","LeakedCredentialCheckResult":"none","MatchIndex":0,"Metadata":{"ruleset_version":"2","version":"1","type":"customer"},"OriginResponseStatus":404,"OriginatorRayID":"00","RayID":"8d389800b7c76c57","Ref":"","RuleID":"af14fd3aedda46898b13c9d033ad0a5f","Source":"firewallcustom"}<br /></code>
        </p>
        <h2>What is Provided</h2>
        <ul>
            <li>We provide categorization for the following log types:
				<ul><li><code class="linecode">HTTP Requests</code></li><li><code class="linecode">Firewall Events</code></li><li><code class="linecode">DNS logs</code></li></ul></li>
            <li>We provide parsing rules to normalize and enrich Cloudflare log messages.</li>
        </ul>
        <h2>Events Processed by This Technology Pack</h2>
        <p>The Cloudflare content pack supports parsing and GIM categorization for the <code class="linecode">HTTP Request</code>, <code class="linecode">Firewall Events</code>, and <code class="linecode">DNS Logs</code> events.</p>
        <h2>Cloudflare Spotlight Content Pack</h2>
        <h3>Cloudflare: Overview Tab</h3>
        <p>
            <img src="../Resources/Images/Cloudflare/cloudflare_overview.png" />
        </p>
        <h3>Cloudflare: HTTP Overview Tab </h3>
        <p>
            <img src="../Resources/Images/Cloudflare/cloudflare_http_overview.png" />
        </p>
        <p>
            <img src="../Resources/Images/Cloudflare/cloudflare_http_overview_2.png" />
        </p>
    </body>
</html>