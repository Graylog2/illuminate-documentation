<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Mimecast Content Pack</title>
        <link href="Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <MadCap:snippetBlock src="Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Mimecast is a cloud-based cybersecurity provider specializing in email security, offering protection against phishing, malware, spam, and data leaks.</p>
        <p>It also delivers services for archiving, continuity, and threat intelligence to help organizations secure their communications and ensure compliance.</p>
        <h2>Supported Versions</h2>
        <ul>
            <li>
                <p>Mimecast API 2.0</p>
            </li>
        </ul>
        <h2>Requirements</h2>
        <ul>
            <li>
                <p>Graylog 6.3.0+ with a valid Enterprise license</p>
            </li>
        </ul>        
        <h2>Stream Configuration</h2>
        <p>This technology pack includes 1 stream:</p>
        <ul>
            <li>Illuminate:Mimecast Messages</li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title"><b>Hint: </b><span style="font-weight: normal;">If this stream does not exist prior to the activation of this pack then it will be created and configured to route messages to this stream and the associated index set. There should not be any stream rules configured for this stream.</span></div>
            </section>
        </p>        
        <h2>Index Set Configuration</h2>
        <p>This technology pack includes 1 index set definition:</p>
        <ul>
            <li>Mimecast Logs</li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="title"><b>Hint: </b><span style="font-weight: normal;">If this index set is already defined, then nothing will be changed. If this index set does not exist, then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.</span></div>
            </section>
        </p>        
        <h2>Log Collection</h2>
        <p>Mimecast utilizes <a href="http://example.com">the Mimecast input</a> that ingests multiple Mimecast content types in JSON format.</p>
        <h3>Configuration Example</h3>
        <p>
            <img src="../Resources/Images/Mimecast Content Pack/input_config.png" />
        </p>
        <h2>Log Format Example</h2>
        <p>This is a generic log representing the typical JSON format of Mimecast logs.</p>
        <h4>General Logs</h4>
        <p><code class="linecode">{"id":"eNoVzt0KgjAAQOF32e0EdWrNoIvZn6UGYZKKNzqHWaai2y4Wv","auditType":"User Logged On","user":"user@domain.com","eventTime":"2025-06-12T14:53:56+0000","eventInfo":"Successful authentication for user@domain.com &lt;Domain User&gt;, Date: 2025-06-12, Time: 16:53:56 SAST, IP: 192.168.100.100, Application: SMTP-MTA2, Method: Cloud","category":"authentication_logs"}</code></p>
        <h2 id="what-is-provided">What is Provided</h2>
        <ul>
            <li>
                <p>Rules to parse, normalize, and enrich Mimecast Content Pack messages</p>
            </li>
            <li>
                <p>A dashboard displaying events and statistics of interest</p>
            </li>
            <li>
                <p>Saved search highlighting key information using a user_email parameter</p>
            </li>
        </ul>
        <h2 id="events-processed-by-this-technology-pack">Events Processed by This Technology Pack</h2>
        <p>The Content Pack supports the following log types. Generic processing will be provided for log types not listed.</p>
        <ul>
            <li>
                <p>User Logged On</p>
            </li>
            <li>
                <p>Unauthorized API Request</p>
            </li>
            <li>
                <p>Case Action</p>
            </li>
            <li>
                <p>Review Set Action</p>
            </li>
            <li>
                <p>Discovery Case Adjustments</p>
            </li>
            <li>
                <p>Logon Authentication Failed</p>
            </li>
            <li>
                <p>Logon Requires Challenge</p>
            </li>
            <li>
                <p>Completed Directory Sync</p>
            </li>
            <li>
                <p>New Policy</p>
            </li>
            <li>
                <p>Existing Policy Changed</p>
            </li>
            <li>
                <p>Mimecast Support Login</p>
            </li>
            <li>
                <p>Content Definition Adjustments</p>
            </li>
            <li>
                <p>Existing Route Changed</p>
            </li>
            <li>
                <p>New Delivery Route</p>
            </li>
            <li>
                <p>Profile Group (Address) Log Entry</p>
            </li>
            <li>
                <p>Account Updated</p>
            </li>
            <li>
                <p>API Application Created</p>
            </li>
            <li>
                <p>User Password Changed</p>
            </li>
            <li>
                <p>User Settings Updated</p>
            </li>
            <li>
                <p>User Locked</p>
            </li>
        </ul>
        <h3 id="gim-categorization">GIM Categorization</h3>
        <p>GIM categorization is provided for the following messages:</p>
        <table cellspacing="21" style="width: 100%; mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');" class="TableStyle-Alternate-Row-Color">
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <thead>
                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Log Type</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">GIM Category</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">GIM Subcategory</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">GIM Event Type Code</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">User Locked</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">iam</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">iam.object disable</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">111500</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">User Settings Updated</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">iam</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">iam.object modify</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">111000</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">User Password Changed</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">iam</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">iam.object modify</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">111004</td>
                </tr>
            </tbody>
        </table>
        <h3 id="message-fields">Message Fields Included in This Pack</h3>
        <h4>Field of Note</h4>
        <table cellspacing="21" style="width: 100%; mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');" class="TableStyle-Alternate-Row-Color">
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <thead>
                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Field Name</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Example Value</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Field Type</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">application_name</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">SMTP-MTA2</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Application extracted from &#39;Application&#39; reference from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">destination_ip</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">8.8.8.8</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">ip</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Destination IP associated with the event pulled from &#39;Remote IP&#39; from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">destination_port</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">25</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">long</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Destination port extracted from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">email_from</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">person@domain</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from .from in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">email_subject</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Test Message</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Extracted from .subject in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">email_to</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">another_person@domain.com</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from .to in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">event_created</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">2025-06-13T14:30:03+0000</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">date</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Timestamp extracted from .eventTime or .viewed in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">event_source</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">JvuS6F0rQmdeSSqcrF8xSAA1BFbYC1Lqkk1A5</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The client_id set in the Mimecast v2 input</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">event_source_product</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">mimecast_v2</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Created via input.  This will always be the same.</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">event_uid</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">JvuVUt30eqQpG3S6F0rQmdeSSqc</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from .id in the JSON body.</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">source_ip</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">192.168.1.100</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">ip</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Source IP that generated the activity.  Extracted from &#39;IP&#39; from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">user_domain</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">example.com</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted domain from user related e-mail&#39;s in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">user_email</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">person@domain.com</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Extracted user e-mail from JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">user_email_display_name</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Random Person</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The display name extracted from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">user_name</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">person</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Multi-value field containing all user_name references in full JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_email_content_viewed_flag</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">false</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from .contentViewed in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_email_date</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">2025-05-30T10:10:32+0000</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">date</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Extracted from .messageDate in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_email_discovery_case_flag</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">true</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from discoverCase in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_event_action</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Successful Authentication</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Vendor&#39;s event action reference extracted from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_event_category</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">authentication_logs</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from .category in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_event_message</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Successful authentication for person@domain.com &lt;SMTP Account&gt;, Date: 2025-06-13, Time: 16:30:03 SAST, IP: 192.168.1.1, Application: SMTP-MTA2, Method: Cloud</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Full .eventInfo from JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_event_method</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Cloud</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Extracted from &#39;Method&#39; reference from .eventInfo in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_event_type</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">User Logged On</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Event type extracted from .auditType in JSON body</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_subtype</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">audit_events</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Created via input and associated configuration</td>
                </tr>
            </tbody>
        </table>
        <h2 id="spotlight-content-pack">Mimecast Spotlight Content Pack</h2>
        <p>This spotlight offers a dashboard with an Overview tab and a saved search tied to the user_name parameter:</p>
        <h3>Overview</h3>
        <p>
            <img src="../Resources/Images/Mimecast Content Pack/overview1.png" />
        </p>
        <p>
            <img src="../Resources/Images/Mimecast Content Pack/overview2.png" />
        </p>
        <p>
            <img src="../Resources/Images/Mimecast Content Pack/overview3.png" />
        </p>
        <h3>Saved Search</h3>
        <p>
            <img src="../Resources/Images/Mimecast Content Pack/saved_search1.png" />
        </p>
    </body>
</html>
