<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head>
        <link href="../Resources/TableStyles/Alternate-Row-Color.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>Cisco Business 350 Series Pack</title>
        <link href="../Resources/Stylesheets/Styles.css" rel="stylesheet" />
    </head>
    <body>
        <MadCap:snippetBlock src="../Resources/Snippets/IlluminateBanner.flsnp" />
        <p>Cisco Business 350 Series Managed Switches are managed Layer 3 network switches designed for small and medium-sized businesses, offering advanced features like VLAN segmentation, static routing, and enhanced security in a simple, intuitive interface.</p>
        <p>This technology pack processes Cisco Business 350 Series (CBS) switch logs, providing normalization and enrichment of common events of interest.</p>
        <h2 id="supported-versions">Supported Version(s)</h2>
        <ul>
            <li>
                <p>Pack created with CBS350 Firmware 3.4.0.17</p>
            </li>
        </ul>
        <h2 id="requirements">Requirements</h2>
        <ul>
            <li>
                <p>Minimum supported version of Graylog.</p>
            </li>
            <li>
                <p>Configure CBS350 device to transmit RFC5424 formatted Syslog to your Graylog server Syslog input.</p>
            </li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="content"><b>Hint:</b> Cisco legacy formatted logs are not currently supported, e.g. <code class="linecode">&lt;190&gt;%COPY-I-FILECPY...</code>.</div>
            </section>
        </p>
        <h2 id="stream-configuration">Stream Configuration</h2>
        <p>This technology pack includes 1 stream:</p>
        <ul>
            <li>"Illuminate:Cisco Device Messages"</li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="content"><b>Hint:</b> If this stream does not exist prior to the activation of this pack then it will be created and configured to route messages to this stream and the associated index set. There should not be any stream rules configured for this stream.</div>
            </section>
        </p>
        <h2 id="index-set-configuration">Index Set Configuration</h2>
        <p>This technology pack includes 1 index set definition:</p>
        <ul>
            <li>Cisco Devices Event Log Messages</li>
        </ul>
        <p>
            <section class="infoBox">
                <div class="content"><b>Hint:</b> If this index set is already defined, then nothing will be changed. If this index set does not exist, then it will be created with retention settings of a daily rotation and 90 days of retention. These settings can be adjusted as required after installation.</div>
            </section>
        </p>
        <p>
            <section class="infoBox">
                <div class="content"><b>Hint:</b> This pack utilizes the general Illuminate <strong>Cisco Devices Event Log Messages</strong> index that most other Cisco related content packs use.
        If you have an existing <strong>Cisco Devices Event Log Messages</strong> index, the CBS logs will reside there.</div>
            </section>
        </p>
        <h2 id="log-collection">Log Collection and Delivery</h2>
        <p>This pack parses logs from the following sources:</p>
        <ul>
            <li>
                <p>Syslog</p>
            </li>
        </ul>
        <h3>Configuration</h3>
        <p>Due to the generic formatting of CBS logs, identifying and parsing these logs can be difficult and</p>
        <p>possibly match non-CBS logs.  To solve this problem, you must configure a CBS-specific input on the Graylog server and use an Illuminate lookup override.  This configuration allows Illuminate to treat every log sent to this input as a CBS message by mapping the input ID to the CBS Illuminate identification rule.  This input should be unique to CBS to ensure this pack processes only CBS logs.</p>
        <ol>
            <li>
                <p>Create a new <a href="https://go2docs.graylog.org/current/getting_in_log_data/syslog_inputs.html">Syslog input</a> in Graylog and choose an unused port.</p>
            </li>
            <li>
                <p>Click <i>Show received messages</i> to obtain the input ID. This action  pulls up a search window with the <i>All Time</i> timeframe.</p>
            </li>
            <li>
                <p>Copy the <code class="linecode">gl2_source_input</code> value.</p>
            </li>
            <li>
                <p>Navigate to <i>Enterprise &gt; Illuminate</i>, then click the <i>Customization</i> tab.</p>
            </li>
            <li>
                <p>Locate the <i>lookup_adapter_input_routing</i> title and click <i>Edit</i>.</p>
            </li>
            <li>
                <p>For <i>Key: <b>content_name</b></i>, enter <strong>cisco_350</strong>, and for the <i>Value: <b>input_id</b></i>, enter the <code class="linecode">gl2_source_input</code> ID copied earlier.</p>
            </li>
            <li>
                <p>Click <i>Configure value</i> to confirm. Graylog identifies all logs sent to the configured input and associated port as  CBS logs, allowing for proper Illuminate processing.</p>
            </li>
            <li>
                <p>Create Illuminate lookup override.</p>
            </li>
        </ol>
        <h2 id="log-format-example">Log Format Example</h2>
        <p>These are example logs for various processed log types.</p>
        <p><code class="linecode">&lt;190&gt;1 2025-01-24T11:09:44.000-08:00 SOME-SWITCH SOMETHING - CONNECT - User CLI session for user some.user over ssh , source 192.168.2.3 destination  192.168.2.10 ACCEPTED
        &lt;190&gt;1 2025-01-24T11:48:30.000-08:00 SOME-SWITCH SOMETHING - SSHSUCC - Connection ID 11 - SSH Session request from 192.168.2.10 port 53865 to Local address 192.168.2.30 port 22, username 'some.user' using crypto cipher aes256-ctr, hmac hmac-sha2-256 succeeded.
        &lt;190&gt;1 2025-01-17T09:27:51.000-08:00 SOME-SWITCh SOMETHING - Up -  gi1/0/47
        &lt;190&gt;1 2025-02-25T00:04:48.000-08:00 SOME-SWITCh SOMETHING - FILECPY - Files Copy - source URL flash://system/configuration/startup-config destination URL flash://system/configuration/mirror-config</code>
        </p>
        <h2 id="what-is-provided">What is Provided</h2>
        <ul>
            <li>
                <p>Rules to parse, normalize, and enrich Content Pack messages.</p>
            </li>
        </ul>
        <h2 id="events-processed-by-this-technology-pack">Events Processed by This Technology Pack</h2>
        <p>The content pack supports the following log types. Generic processing will be provided for log types not listed.</p>
        <ul>
            <li>
                <p>NATIVE_VLAN_MISMATCH</p>
            </li>
            <li>
                <p>PORTSTATUS</p>
            </li>
            <li>
                <p>SECSYNBLOCKED</p>
            </li>
            <li>
                <p>SNMPAUTHFAIL</p>
            </li>
            <li>
                <p>SSHFAIL</p>
            </li>
            <li>
                <p>LOG</p>
            </li>
            <li>
                <p>FILECPY</p>
            </li>
            <li>
                <p>REJECT</p>
            </li>
            <li>
                <p>Up</p>
            </li>
            <li>
                <p>Down</p>
            </li>
            <li>
                <p>SHUTDWN</p>
            </li>
            <li>
                <p>SSHSUCC</p>
            </li>
            <li>
                <p>CONNECT</p>
            </li>
            <li>
                <p>DISCONNECT</p>
            </li>
            <li>
                <p>EeeLldpMultiNeighbours</p>
            </li>
        </ul>
        <h3>Message Fields Included in This Pack</h3>
        <h4>General Parsing</h4>
        <p>Common Fields List <span style="font-size: 8pt;">▼</span></p>
        <table cellspacing="21" style="width: 100%; mc-table-style: url('../Resources/TableStyles/Alternate-Row-Color.css');" class="TableStyle-Alternate-Row-Color">
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <col class="TableStyle-Alternate-Row-Color-Column-Column1" />
            <thead>
                <tr class="TableStyle-Alternate-Row-Color-Head-Header1">
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Field Name</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Example Value</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadE-Column1-Header1">Field Type</th>
                    <th class="TableStyle-Alternate-Row-Color-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">application_name</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">PNPAGENT</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">This field is generated by the Syslog input when analyzing the syslog message</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">destination_ip</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">192.168.2.10</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">long</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">IP address of the destination host</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">destination_port</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">22</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">long</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Port the client connects to</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">event_source</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">GL-SWITCH</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Syslog hostname in delivered message</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">event_source_product</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">cisco_350</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">The default event_source_product for CBS processed logs</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">network_interface</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">gi1/0/47</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The network interface(s) noted in the message</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">source_ip</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">192.168.2.3</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">long</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">IP address of the source host</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">source_port</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">12345</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">long</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Port from which the client initiates</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">user_name</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">some.user</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">User name tied to the message</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_crypto_cipher</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">aes256-ctr</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The cypher used to encrypt the communication</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_crypto_hmac</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">hmac-sha2-256</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">The HMAC used in the communication</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_connection_id</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">14</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The connection ID associated with the connection</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_destination_file_name</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">mirror-config</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">The destination file name noted in message</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_destination_protocol</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">flash</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The destination protocol noted in the message (flash/http/https/etc.)</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_destination_request_path</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">/system/configuration/mirror-config</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">The destination file path</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_event_message</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">Backoff PnP Request with &lt;callbackAfter&gt; has received: 24 Hours 0 Minutes 0 Seconds</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">Main event message contained in log and will only exist for log types not noted as supported</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_event_outcome</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">Bye Bye</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">The outcome from the associated connection</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_event_outcome_code</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">11</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The outcome code from the associated connection</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_event_outcome_reason</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">identification exchange failed</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">Additionally provided info related to the outcome of the associated connection</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">vendor_source_request_path</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">/system/configuration/startup-config</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body2">The source file path</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body1">
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">vendor_source_request_protocol</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">flash</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyE-Column1-Body1">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyD-Column1-Body1">The source protocol noted in the message (flash/http/https/etc.)</td>
                </tr>
                <tr class="TableStyle-Alternate-Row-Color-Body-Body2">
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">vendor_subtype</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">BACKOFFCALLBACKAFTER</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyB-Column1-Body2">keyword</td>
                    <td class="TableStyle-Alternate-Row-Color-BodyA-Column1-Body2">This field is extracted is the CBS message ID or event identifier</td>
                </tr>
            </tbody>
        </table>
    </body>
</html>